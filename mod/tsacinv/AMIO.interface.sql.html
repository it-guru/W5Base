<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<title>/apps/w5base/opt/w5base/mod/tsacinv/AMIO.interface.sql.html</title>
<meta name="Generator" content="Vim/7.4">
<meta name="plugin-version" content="vim7.4_v1">
<meta name="syntax" content="sql">
<meta name="settings" content="use_css,pre_wrap,no_foldcolumn,expand_tabs,prevent_copy=">
<meta name="colorscheme" content="none">
<style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
* { font-size: 1em; }
.Comment { color: #8080ff; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Statement { color: #8080ff; font-weight: bold; }
.Type { color: #808080; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- Interface Control Table ----------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Comment">-- drop table &quot;IFACE_ACL&quot;;</span>
<span class="Statement">create</span> <span class="Special">table</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> (
   ifuser       <span class="Type">varchar2</span>(<span class="Constant">33</span>) <span class="Statement">not</span> <span class="Special">null</span>,
   assignment   <span class="Type">varchar2</span>(<span class="Constant">128</span>),
   acctno       <span class="Type">varchar2</span>(<span class="Constant">70</span>),
   customerlnk  <span class="Type">varchar2</span>(<span class="Constant">128</span>)
);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> <span class="Special">values</span>(<span class="Constant">'CSS.T-COM'</span>,<span class="Constant">'TIT'</span>,<span class="Special">NULL</span>,<span class="Special">NULL</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> <span class="Special">values</span>(<span class="Constant">'CSS.T-COM'</span>,<span class="Constant">'TIT.%'</span>,<span class="Special">NULL</span>,<span class="Special">NULL</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> (ifuser,acctno) <span class="Special">values</span>(<span class="Constant">'CSS.T-COM'</span>,<span class="Constant">'8111'</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> (ifuser,customerlnk) <span class="Special">values</span>(<span class="Constant">'CSS.T-COM'</span>,<span class="Constant">'DTAG.TEL-IT'</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> (ifuser,customerlnk) <span class="Special">values</span>(<span class="Constant">'CSS.T-COM'</span>,<span class="Constant">'DTAG.TEL-IT.%'</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> <span class="Special">values</span>(<span class="Constant">'TEL_IT_DARWIN'</span>,<span class="Constant">'TIT'</span>,<span class="Special">NULL</span>,<span class="Special">NULL</span>);
<span class="Statement">insert</span> <span class="Special">into</span> <span class="Constant">&quot;IFACE_ACL&quot;</span> (ifuser,acctno) <span class="Special">values</span>(<span class="Constant">'TEL_IT_DARWIN'</span>,<span class="Constant">'8111'</span>);



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- iface ----------------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Erlaubt es den Schnittstellen-Usern ihre eigenen aktiven ACLs </span>
<span class="Comment">--   abzufragen.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">view</span> iface <span class="Special">as</span>
   <span class="Statement">select</span> * <span class="Special">from</span> IFACE_ACL
   <span class="Special">WHERE</span> ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> iface <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::appl   ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Anwendungs Datensatz wird dadurch eingeschraenkt,</span>
<span class="Comment">--   dass der Schnittstellen-User ueber die IFACE_ACL entweder den Zugriff</span>
<span class="Comment">--   auf den Buchungskreis, die Assignmentgroup der Anwendung oder den aus</span>
<span class="Comment">--   dem Kontierungsobjekt resultierenden Customer-Link haben muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">view</span> appl_acl <span class="Special">as</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> amtsicustappl.code id
   <span class="Special">from</span> AM2107.amtsicustappl
      left outer join ( <span class="Statement">SELECT</span> amcostcenter.*
                        <span class="Special">FROM</span> AM2107.amcostcenter
                        <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">on</span> amtsicustappl.lcostcenterid = amcostcenter.lcostid
      left outer join AM2107.amemplgroup assigrp
         <span class="Special">on</span> amtsicustappl.lassignmentid = assigrp.lgroupid
      left outer join AM2107.amtsiaccsecunit customerlnk
            <span class="Special">on</span> amcostcenter.lcustomerlinkid=customerlnk.lunitid
      join IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>) <span class="Statement">and</span>
             (assigrp.name <span class="Statement">like</span> acl.assignment
                <span class="Statement">or</span> acl.assignment <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (amcostcenter.acctno <span class="Statement">like</span> acl.acctno
                <span class="Statement">or</span> acl.acctno <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (customerlnk.identifier <span class="Statement">like</span> acl.customerlnk
                <span class="Statement">or</span> acl.customerlnk <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
            (acl.customerlnk <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.acctno <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.assignment <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">view</span> appl <span class="Special">as</span>
   <span class="Statement">SELECT</span>
      amtsicustappl.code                             <span class="Constant">&quot;applid&quot;</span>,
      concat(concat(concat(amtsicustappl.name,<span class="Constant">' ('</span>),
      amtsicustappl.code),<span class="Constant">')'</span>)                       <span class="Constant">&quot;fullname&quot;</span>,
      amtsicustappl.ltsicustapplid                   <span class="Constant">&quot;id&quot;</span>,
      amtsicustappl.name                             <span class="Constant">&quot;name&quot;</span>,
      LOWER ( amtsicustappl.status)                  <span class="Constant">&quot;status&quot;</span>,
      amtsicustappl.bdelete                          <span class="Constant">&quot;deleted&quot;</span>,
      amtsicustappl.usage                            <span class="Constant">&quot;usage&quot;</span>,
      amtsicustappl.businessimpact                   <span class="Constant">&quot;criticality&quot;</span>,
      amtsicustappl.priority                         <span class="Constant">&quot;customerprio&quot;</span>,
      amcostcenter.lcustomerlinkid                   <span class="Constant">&quot;lcustomerid&quot;</span>,
      amtsicustappl.lsecurityunitid                  <span class="Constant">&quot;lsecunitid&quot;</span>,
      amtsicustappl.lincidentagid                    <span class="Constant">&quot;lincidentagid&quot;</span>,
      amtsicustappl.lchangeapprid                    <span class="Constant">&quot;lchhangeapprid&quot;</span>,
      amtsicustappl.lchangeimplid                    <span class="Constant">&quot;lchhangeimplid&quot;</span>,
      amtsicustappl.lservicecontactid                <span class="Constant">&quot;semid&quot;</span>,
      amtsicustappl.ltechnicalcontactid              <span class="Constant">&quot;tsmid&quot;</span>,
      amtsicustappl.ldeputytechnicalcontactid        <span class="Constant">&quot;tsm2id&quot;</span>,
      amtsicustappl.lleaddemid                       <span class="Constant">&quot;opmid&quot;</span>,
      amtsicustappl.ldeputydemid                     <span class="Constant">&quot;opm2id&quot;</span>,
      amtsicustappl.lassignmentid                    <span class="Constant">&quot;lassignmentid&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Constant">&quot;conumber&quot;</span>,
      amtsicustappl.ref                              <span class="Constant">&quot;ref&quot;</span>,
      amtsicustappl.lcostcenterid                    <span class="Constant">&quot;lcostid&quot;</span>,
      amtsicustappl.version                          <span class="Constant">&quot;version&quot;</span>,
      amtsicustappl.soxrelevant                      <span class="Constant">&quot;issoxappl&quot;</span>,
      businessdesc.memcomment                        <span class="Constant">&quot;description&quot;</span>,
      amtsimaint.memcomment                          <span class="Constant">&quot;maintwindow&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Constant">&quot;altbc&quot;</span>,
      decode ( tbsm.ordered, <span class="Constant">'XMBSM'</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)          <span class="Constant">&quot;tbsm_ordered&quot;</span>,
      amtsicustappl.dtlastmodif                      <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad ( amtsicustappl.code, <span class="Constant">35</span>, <span class="Constant">'0'</span>)            <span class="Constant">&quot;replkeysec&quot;</span>,
      amtsicustappl.dtcreation                       <span class="Constant">&quot;cdate&quot;</span>,
      amtsicustappl.dtlastmodif                      <span class="Constant">&quot;mdate&quot;</span>,
      amtsicustappl.dtlastmodif                      <span class="Constant">&quot;mdaterev&quot;</span>,
      amtsicustappl.externalsystem                   <span class="Constant">&quot;srcsys&quot;</span>,
      amtsicustappl.externalid                       <span class="Constant">&quot;srcid&quot;</span>,
      amtsicustappl.dtimport                         <span class="Constant">&quot;srcload&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amtsicustappl
      join appl_acl <span class="Special">on</span> amtsicustappl.code=appl_acl.id
      left outer join ( <span class="Statement">SELECT</span> amcostcenter.* <span class="Special">FROM</span> AM2107.amcostcenter
                        <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">on</span> amtsicustappl.lcostcenterid = amcostcenter.lcostid
      left outer join AM2107.amemplgroup assigrp
         <span class="Special">on</span> amtsicustappl.lassignmentid = assigrp.lgroupid
      left outer join (
         <span class="Statement">SELECT</span>
            <span class="Statement">distinct</span> amtsiservicetype.identifier ordered,
            amtsicustappl.ltsicustapplid
         <span class="Special">FROM</span>
            AM2107.amtsiservice,
            AM2107.amtsiservicetype,
            AM2107.amtsirelportfappl,
            AM2107.amtsicustappl,
            AM2107.amportfolio
         <span class="Special">WHERE</span>
            amtsiservice.lservicetypeid = amtsiservicetype.ltsiservicetypeid
            <span class="Statement">AND</span> amtsiservicetype.identifier = <span class="Constant">'XMBSM'</span>
            <span class="Statement">AND</span> amtsiservice.bdelete = <span class="Constant">0</span>
            <span class="Statement">AND</span> amtsirelportfappl.bdelete = <span class="Constant">0</span>
            <span class="Statement">AND</span> amtsiservice.lportfolioid = amtsirelportfappl.lportfolioid
            <span class="Statement">AND</span> amtsirelportfappl.bactive = <span class="Constant">1</span>
            <span class="Statement">AND</span> amtsirelportfappl.lapplicationid = amtsicustappl.ltsicustapplid
            <span class="Statement">AND</span> amtsirelportfappl.lportfolioid = amportfolio.lportfolioitemid
            <span class="Statement">AND</span> amportfolio.bdelete = <span class="Constant">0</span>
         ) tbsm
         <span class="Special">on</span> amtsicustappl.ltsicustapplid = tbsm.ltsicustapplid
      left outer join AM2107.amcomment amtsimaint
         <span class="Special">on</span> amtsicustappl.lmaintwindowid = amtsimaint.lcommentid
      left outer join AM2107.amcomment businessdesc
         <span class="Special">on</span> amtsicustappl.lcustbusinessdescid = businessdesc.lcommentid
      left outer join AM2107.amtsiaccsecunit customerlnk
         <span class="Special">on</span> amcostcenter.lcustomerlinkid=customerlnk.lunitid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> appl <span class="Special">to</span> <span class="Special">public</span>;

<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::system (pre) ------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>


<span class="Comment">-- drop materialized view system_acl_l0;</span>
<span class="Statement">CREATE</span> MATERIALIZED <span class="Special">VIEW</span> system_acl_l0
  <span class="Comment">-- refresh complete start with sysdate</span>
  <span class="Comment">-- next trunc(sysdate+1)+5.2/24</span>
  refresh complete <span class="Special">start</span> <span class="Special">with</span> trunc(<span class="Statement">sysdate</span>+<span class="Constant">1</span>)+<span class="Constant">5.2</span>/<span class="Constant">24</span>
  next <span class="Statement">sysdate</span>+<span class="Constant">0</span>.<span class="Constant">125</span>
  <span class="Special">as</span>
  <span class="Statement">select</span> <span class="Statement">distinct</span> acl.ifuser,amportfolio.assettag id
   <span class="Special">from</span> AM2107.amportfolio
      left outer join ( <span class="Statement">SELECT</span> amcostcenter.*
                        <span class="Special">FROM</span> AM2107.amcostcenter
                        <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">on</span> amportfolio.lcostid = amcostcenter.lcostid
      left outer join AM2107.amemplgroup assigrp
         <span class="Special">on</span> amportfolio.lassignmentid = assigrp.lgroupid
      left outer join AM2107.amtsiaccsecunit customerlnk
            <span class="Special">on</span> amcostcenter.lcustomerlinkid=customerlnk.lunitid
      join IFACE_ACL acl
         <span class="Special">on</span>  (assigrp.name <span class="Statement">like</span> acl.assignment
                <span class="Statement">or</span> acl.assignment <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (amcostcenter.acctno <span class="Statement">like</span> acl.acctno
                <span class="Statement">or</span> acl.acctno <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (customerlnk.identifier <span class="Statement">like</span> acl.customerlnk
                <span class="Statement">or</span> acl.customerlnk <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
            (acl.customerlnk <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.acctno <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.assignment <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>);

<span class="Statement">CREATE</span> <span class="Special">INDEX</span> system_acl_l0_i0
   <span class="Special">ON</span> system_acl_l0 (id,ifuser) <span class="Special">online</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnksharednet ------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- - Der Zugriff auf die Shared-Network Componenten wird dadurch            -</span>
<span class="Comment">-- - Eingegrenzt, das nur die Shared-Network Componenten an den fuer den    -</span>
<span class="Comment">-- - Schnittstellen-User sichtbaren logischen Systeme (und zwar nur die     -</span>
<span class="Comment">-- - logischen Systeme, die er auch wirklich DIREKT sehen darf) dargestellt -</span>
<span class="Comment">-- - werden.                                                                -</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>


<span class="Comment">-- drop materialized view lnksharednet_acl_l0;</span>
<span class="Statement">CREATE</span> MATERIALIZED <span class="Special">VIEW</span> lnksharednet_acl_l0
  <span class="Comment">-- refresh complete start with sysdate</span>
  <span class="Comment">-- next trunc(sysdate+1)+5.4/24</span>
  refresh complete <span class="Special">start</span> <span class="Special">with</span> trunc(<span class="Statement">sysdate</span>+<span class="Constant">1</span>)+<span class="Constant">5.4</span>/<span class="Constant">24</span>
  next <span class="Statement">sysdate</span>+<span class="Constant">0</span>.<span class="Constant">125</span>
  <span class="Special">as</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> TsiParentChild.ltsiparentchildid  <span class="Special">AS</span> <span class="Constant">&quot;netlnkid&quot;</span>,
      system_acl_l0.ifuser                           <span class="Special">AS</span> <span class="Constant">&quot;IFUSER&quot;</span>,
      TsiParentChild.description                     <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      systemportfolio.assettag                       <span class="Special">AS</span> <span class="Constant">&quot;systemsystemid&quot;</span>,
      netportfolio.assettag                          <span class="Special">AS</span> <span class="Constant">&quot;netsystemid&quot;</span>,
      netpartnernature.name                          <span class="Special">AS</span> <span class="Constant">&quot;netnature&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>
   <span class="Special">FROM</span> AM2107.amcomputer
      JOIN AM2107.amportfolio systemportfolio
         <span class="Special">ON</span> ( amcomputer.litemid = systemportfolio.lportfolioitemid
              <span class="Statement">AND</span> systemportfolio.bdelete = <span class="Constant">'0'</span>)
      JOIN ( <span class="Statement">SELECT</span> amTsiParentChild.ltsiparentchildid,
                    amTsiParentChild.lparentid a,
                    amTsiParentChild.lchildid b,
                    amTsiParentChild.description
                 <span class="Special">FROM</span> AM2107.amTsiParentChild
                 <span class="Special">WHERE</span> externalsystem = <span class="Constant">'Autodiscovery'</span>
             <span class="Statement">UNION</span> <span class="Statement">ALL</span>
             <span class="Statement">SELECT</span> amTsiParentChild.ltsiparentchildid,
                    amTsiParentChild.lchildid a,
                    amTsiParentChild.lparentid b,
                    amTsiParentChild.description
             <span class="Special">FROM</span> AM2107.amTsiParentChild
             <span class="Special">WHERE</span> externalsystem = <span class="Constant">'Autodiscovery'</span>
      ) TsiParentChild
         <span class="Special">ON</span> systemportfolio.lportfolioitemid = TsiParentChild.a
      JOIN AM2107.amportfolio netportfolio
         <span class="Special">ON</span> ( TsiParentChild.b = netportfolio.lportfolioitemid
              <span class="Statement">AND</span> netportfolio.bdelete = <span class="Constant">'0'</span>)
      JOIN AM2107.amcomputer netcomputer
         <span class="Special">ON</span> ( netcomputer.litemid = netportfolio.lportfolioitemid
         <span class="Statement">AND</span> netcomputer.status &lt;&gt; <span class="Constant">'out of operation'</span>)
      JOIN AM2107.amportfolio netpartnerportfolio
         <span class="Special">ON</span> netportfolio.lparentid = netpartnerportfolio.lportfolioitemid
      JOIN AM2107.ammodel netpartnermodel
         <span class="Special">ON</span> netpartnerportfolio.lmodelid = netpartnermodel.lmodelid
      JOIN AM2107.amnature netpartnernature
         <span class="Special">ON</span> netpartnermodel.lnatureid = netpartnernature.lnatureid
      LEFT OUTER JOIN AM2107.amtsirelportfappl
         <span class="Special">ON</span> ( systemportfolio.lportfolioitemid = amtsirelportfappl.lportfolioid
              <span class="Statement">AND</span> amtsirelportfappl.bdelete = <span class="Constant">'0'</span>)
      JOIN system_acl_l0
         <span class="Special">ON</span> systemportfolio.assettag=system_acl_l0.id;

<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharednet_acl_l0_i0
   <span class="Special">ON</span> lnksharednet_acl_l0 (<span class="Constant">&quot;netlnkid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharednet_acl_l0_i1
   <span class="Special">ON</span> lnksharednet_acl_l0 (<span class="Constant">&quot;lcomputerid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharednet_acl_l0_i2
   <span class="Special">ON</span> lnksharednet_acl_l0 (<span class="Constant">&quot;systemsystemid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharednet_acl_l0_i3
   <span class="Special">ON</span> lnksharednet_acl_l0 (<span class="Constant">&quot;netsystemid&quot;</span>) <span class="Special">online</span>;


<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksharednet_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> lnksharednet_acl_l0.<span class="Constant">&quot;netlnkid&quot;</span> id
   <span class="Special">FROM</span> lnksharednet_acl_l0
   <span class="Special">WHERE</span> lnksharednet_acl_l0.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksharednet <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> lnksharednet_acl_l0.<span class="Constant">&quot;netlnkid&quot;</span>,
      lnksharednet_acl_l0.<span class="Constant">&quot;description&quot;</span>,
      amtsicustappl.code                             <span class="Special">AS</span> <span class="Constant">&quot;applid&quot;</span>,
      amtsicustappl.name                             <span class="Special">AS</span> <span class="Constant">&quot;applname&quot;</span>,
      lnksharednet_acl_l0.<span class="Constant">&quot;systemsystemid&quot;</span>,
      systemportfolio.name                           <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      lnksharednet_acl_l0.<span class="Constant">&quot;netsystemid&quot;</span>,
      netportfolio.name                              <span class="Special">AS</span> <span class="Constant">&quot;netname&quot;</span>,
      lnksharednet_acl_l0.<span class="Constant">&quot;netnature&quot;</span>,
      lnksharednet_acl_l0.<span class="Constant">&quot;lcomputerid&quot;</span>
   <span class="Special">FROM</span> lnksharednet_acl_l0
      JOIN lnksharednet_acl
         <span class="Special">ON</span> lnksharednet_acl_l0.<span class="Constant">&quot;netlnkid&quot;</span>=lnksharednet_acl.id
      JOIN AM2107.amportfolio netportfolio
         <span class="Special">ON</span> lnksharednet_acl_l0.<span class="Constant">&quot;netsystemid&quot;</span> = netportfolio.assettag
      JOIN AM2107.amportfolio systemportfolio
         <span class="Special">ON</span> lnksharednet_acl_l0.<span class="Constant">&quot;systemsystemid&quot;</span> = systemportfolio.assettag
      LEFT OUTER JOIN AM2107.amtsirelportfappl
         <span class="Special">ON</span> ( systemportfolio.lportfolioitemid = amtsirelportfappl.lportfolioid
              <span class="Statement">AND</span> amtsirelportfappl.bdelete = <span class="Constant">'0'</span>)
      LEFT OUTER JOIN AM2107.amtsicustappl
         <span class="Special">ON</span> amtsirelportfappl.lapplicationid = amtsicustappl.ltsicustapplid
   <span class="Special">WHERE</span>  lnksharednet_acl_l0.<span class="Constant">&quot;netnature&quot;</span> <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>
      <span class="Statement">and</span> lnksharednet_acl_l0.<span class="Constant">&quot;netnature&quot;</span> <span class="Statement">not</span> <span class="Statement">in</span> (<span class="Constant">'SERVER'</span>,<span class="Constant">'TERMINAL-SERVER'</span>);

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnksharednet <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::system ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen logischen System Datensatz wird dadurch</span>
<span class="Comment">--   eingeschraenkt, dass der Schnittstellen-User ueber die IFACE_ACL</span>
<span class="Comment">--   entweder den Zugriff auf den Buchungskreis, die Assignmentgroup</span>
<span class="Comment">--   des logischen Systems oder den aus dem Kontierungsobjekt</span>
<span class="Comment">--   resultierenden Customer-Link haben muss.</span>
<span class="Comment">--   Desweiteren werden alle System-Datensaetze sichtbar, die als</span>
<span class="Comment">--   &quot;shared-Network&quot; Componenten erkannt wurden (1x tgl. ermittelt)</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Comment">-- drop materialized view system_acl_l1;</span>
<span class="Statement">CREATE</span> MATERIALIZED <span class="Special">VIEW</span> system_acl_l1
  <span class="Comment">-- refresh complete start with sysdate</span>
  <span class="Comment">-- next trunc(sysdate+1)+5.6/24</span>
  refresh complete <span class="Special">start</span> <span class="Special">with</span> trunc(<span class="Statement">sysdate</span>+<span class="Constant">1</span>)+<span class="Constant">5.6</span>/<span class="Constant">24</span>
  next <span class="Statement">sysdate</span>+<span class="Constant">0</span>.<span class="Constant">125</span>
  <span class="Special">as</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> * <span class="Special">from</span> (
      <span class="Statement">select</span> ifuser,<span class="Constant">&quot;netsystemid&quot;</span> id <span class="Special">from</span> lnksharednet_acl_l0
      <span class="Statement">union</span>
      <span class="Statement">select</span> ifuser,id <span class="Special">from</span> system_acl_l0
   ) acltable;

<span class="Statement">CREATE</span> <span class="Special">INDEX</span> system_acl_l1_i0
   <span class="Special">ON</span> system_acl_l1 (id,ifuser) <span class="Special">online</span>;

<span class="Statement">CREATE</span> <span class="Special">INDEX</span> system_acl_l1_i1
   <span class="Special">ON</span> system_acl_l1 (ifuser,id) <span class="Special">online</span>;


<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> system_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> id <span class="Special">from</span>
       system_acl_l1 <span class="Special">where</span> ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);
<span class="Comment">-- test: DEMD1XCP0002 (S20148097)  QDE8HV (S21938047)</span>


<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> system <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      concat(concat(concat(amportfolio.name,<span class="Constant">' ('</span>),
         amportfolio.assettag),<span class="Constant">')'</span>)                  <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      LOWER ( amcomputer.status)                     <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      assetportfolio.bdelete                         <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;conumber&quot;</span>,
      amcostcenter.customerlink                      <span class="Special">AS</span> <span class="Constant">&quot;customerlink&quot;</span>,
      amcostcenter.lcostid                           <span class="Special">AS</span> <span class="Constant">&quot;lcostcenterid&quot;</span>,
      amcostcenter.customeroffice                    <span class="Special">AS</span> <span class="Constant">&quot;cocustomeroffice&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;bc&quot;</span>,
      decode ( amcostcenter.hier0id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier0id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier1id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier1id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier2id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier2id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier3id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier3id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier4id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier4id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier5id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier5id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier6id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier6id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier7id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier7id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier8id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier8id
      ) || <span class="Constant">'.'</span> || decode ( amcostcenter.hier9id,
         <span class="Constant">''</span>, <span class="Constant">'-'</span>, amcostcenter.hier9id
      )                                              <span class="Special">AS</span> <span class="Constant">&quot;saphier&quot;</span>,
      amportfolio.lsupervid                          <span class="Special">AS</span> <span class="Constant">&quot;supervid&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amportfolio.lincidentagid                      <span class="Special">AS</span> <span class="Constant">&quot;lincidentagid&quot;</span>,
      amportfolio.controlcenter                      <span class="Special">AS</span> <span class="Constant">&quot;controlcenter&quot;</span>,
      amportfolio.controlcenter2                     <span class="Special">AS</span> <span class="Constant">&quot;controlcenter2&quot;</span>,
      amportfolio.usage                              <span class="Special">AS</span> <span class="Constant">&quot;usage&quot;</span>,
      amcomputer.computertype                        <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      ammodel.name                                   <span class="Special">AS</span> <span class="Constant">&quot;model&quot;</span>,
      amnature.name                                  <span class="Special">AS</span> <span class="Constant">&quot;nature&quot;</span>,
      decode (amportfolio.soxrelevant,<span class="Constant">'YES'</span>,<span class="Constant">1</span>,<span class="Constant">0</span>)     <span class="Special">AS</span> <span class="Constant">&quot;soxrelevant&quot;</span>,
      decode ( amcomputer.addsysname,
         <span class="Constant">'+VS+'</span>,<span class="Constant">'VS'</span>,      <span class="Constant">'+VS++'</span>,<span class="Constant">'VS'</span>,
         <span class="Constant">'++VS+'</span>,<span class="Constant">'VS'</span>,     <span class="Constant">'+GS+'</span>,<span class="Constant">'GS'</span>,
         <span class="Constant">'+GS++'</span>,<span class="Constant">'GS'</span>,     <span class="Constant">'++GS+'</span>,<span class="Constant">'GS'</span>,
         <span class="Constant">'NONE'</span>)                                     <span class="Special">AS</span> <span class="Constant">&quot;securitymodel&quot;</span>,
      amcomputer.addsysname                          <span class="Special">AS</span> <span class="Constant">&quot;altname&quot;</span>,
      amportfolio.securityset                        <span class="Special">AS</span> <span class="Constant">&quot;securityset&quot;</span>,
      amcomputer.itotalnumberofcores                 <span class="Special">AS</span> <span class="Constant">&quot;systemcpucount&quot;</span>,
      amcomputer.fcpunumber                          <span class="Special">AS</span> <span class="Constant">&quot;systeminvoicecpucount&quot;</span>,
      amcomputer.lcpuspeedmhz                        <span class="Special">AS</span> <span class="Constant">&quot;systemcpuspeed&quot;</span>,
      amcomputer.cputype                             <span class="Special">AS</span> <span class="Constant">&quot;systemcputype&quot;</span>,
      amcomputer.lProcCalcSpeed                      <span class="Special">AS</span> <span class="Constant">&quot;systemtpmc&quot;</span>,
      amcomputer.lmemorysizemb                       <span class="Special">AS</span> <span class="Constant">&quot;systemmemory&quot;</span>,
      amcomputer.virtualization                      <span class="Special">AS</span> <span class="Constant">&quot;virtualization&quot;</span>,
      TRIM(amcomputer.operatingsystem)               <span class="Special">AS</span> <span class="Constant">&quot;systemos&quot;</span>,
      amcomputer.osservicelevel                      <span class="Special">AS</span> <span class="Constant">&quot;systemospatchlevel&quot;</span>,
      amcomputer.psystempartofasset                  <span class="Special">AS</span> <span class="Constant">&quot;partofasset&quot;</span>,
      amcomputer.psystempartofasset * <span class="Constant">100</span>            <span class="Special">AS</span> <span class="Constant">&quot;nativepartofasset&quot;</span>,
      amcomputer.olaclasssystem                      <span class="Special">AS</span> <span class="Constant">&quot;systemola&quot;</span>,
      amcomputer.seappcom                            <span class="Special">AS</span> <span class="Constant">&quot;systemolaclass&quot;</span>,
      decode ( amcomputer.seappcom,
         <span class="Constant">'0'</span>,<span class="Constant">'UNDEFINED'</span>,    <span class="Constant">'4'</span>,<span class="Constant">'UNIVERSAL'</span>,
         <span class="Constant">'10'</span>,<span class="Constant">'CLASSIC'</span>,     <span class="Constant">'20'</span>,<span class="Constant">'STANDARDIZED'</span>,
         <span class="Constant">'25'</span>,<span class="Constant">'STANDARDIZED SLICE'</span>,
         <span class="Constant">'30'</span>,<span class="Constant">'APPCOM'</span>,      <span class="Constant">'33'</span>,<span class="Constant">'DCS'</span>,
         amcomputer.seappcom || <span class="Constant">'???'</span>
      )                                              <span class="Special">AS</span> <span class="Constant">&quot;rawsystemolaclass&quot;</span>,
      amportfolio.priority                           <span class="Special">AS</span> <span class="Constant">&quot;priority&quot;</span>,
      decode(amportfolio.dtinvent,
            <span class="Special">NULL</span>,assetportfolio.dtinvent,
            amportfolio.dtinvent)                    <span class="Special">AS</span> <span class="Constant">&quot;installdate&quot;</span>,
      amcomputer.psystempartofasset                  <span class="Special">AS</span> <span class="Constant">&quot;partofassetdec&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>,
      amportfolio.lparentid                          <span class="Special">AS</span> <span class="Constant">&quot;lassetid&quot;</span>,
      amcomputer.lparentid                           <span class="Special">AS</span> <span class="Constant">&quot;lclusterid&quot;</span>,
      amportfolio.lportfolioitemid                   <span class="Special">AS</span> <span class="Constant">&quot;lportfolioitemid&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;altbc&quot;</span>,
      decode(tbsm.ordered,<span class="Constant">'XMBSM'</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)             <span class="Special">AS</span> <span class="Constant">&quot;tbsm_ordered&quot;</span>,
      amcomputer.servicename                         <span class="Special">AS</span> <span class="Constant">&quot;acmdbcontract&quot;</span>,
      amcomputer.slanumber                           <span class="Special">AS</span> <span class="Constant">&quot;acmdbcontractnumber&quot;</span>,
      amportfolio.dtinvent                           <span class="Special">AS</span> <span class="Constant">&quot;instdate&quot;</span>,
      amcomment.memcomment                           <span class="Special">AS</span> <span class="Constant">&quot;tcomments&quot;</span>,
      decode(amtsiautodiscovery.name,<span class="Special">NULL</span>,<span class="Constant">''</span>,
         amtsiautodiscovery.name||<span class="Constant">' ('</span>||
         amtsiautodiscovery.assettag||<span class="Constant">') - '</span>||
         amtsiautodiscovery.source)                  <span class="Special">AS</span> <span class="Constant">&quot;autodiscent&quot;</span>,
      amportfolio.dtcreation                         <span class="Special">AS</span> <span class="Constant">&quot;cdate&quot;</span>,
      amportfolio.dtlastmodif                        <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
      amportfolio.dtlastmodif                        <span class="Special">AS</span> <span class="Constant">&quot;mdaterev&quot;</span>,
      amportfolio.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amportfolio.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>,
      amportfolio.dtlastmodif                        <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(amportfolio.assettag,<span class="Constant">35</span>,<span class="Constant">'0'</span>)              <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amcomputer
      JOIN AM2107.amportfolio
         <span class="Special">ON</span> amcomputer.litemid = amportfolio.lportfolioitemid
      JOIN system_acl
         <span class="Special">ON</span> amportfolio.assettag=system_acl.id
      JOIN AM2107.amportfolio assetportfolio
         <span class="Special">ON</span> amportfolio.lparentid = assetportfolio.lportfolioitemid
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
      JOIN AM2107.amnature
         <span class="Special">ON</span> ammodel.lnatureid = amnature.lnatureid
      LEFT OUTER JOIN (
         <span class="Statement">SELECT</span> amcostcenter.*, amtsiaccsecunit.identifier  customerlink
         <span class="Special">FROM</span> AM2107.amcostcenter
            LEFT OUTER JOIN AM2107.amtsiaccsecunit
               <span class="Special">ON</span> amcostcenter.lcustomerlinkid = amtsiaccsecunit.lunitid
         <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span> ) amcostcenter
         <span class="Special">ON</span> amportfolio.lcostid = amcostcenter.lcostid
      LEFT OUTER JOIN (
         <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsiservicetype.identifier ordered,
                         amtsiservice.lportfolioid
         <span class="Special">FROM</span> AM2107.amtsiservice, AM2107.amtsiservicetype
         <span class="Special">WHERE</span>
            amtsiservice.lservicetypeid = amtsiservicetype.ltsiservicetypeid
            <span class="Statement">AND</span> amtsiservicetype.identifier = <span class="Constant">'XMBSM'</span>
            <span class="Statement">AND</span> amtsiservice.bdelete = <span class="Constant">0</span> ) tbsm
         <span class="Special">ON</span> amportfolio.lportfolioitemid = tbsm.lportfolioid
      LEFT OUTER JOIN AM2107.amcomment
         <span class="Special">ON</span> amcomputer.lcommentid = amcomment.lcommentid
      LEFT OUTER JOIN AM2107.amtsiautodiscovery
         <span class="Special">ON</span> amportfolio.assettag = amtsiautodiscovery.assettag
   <span class="Special">WHERE</span> amcomputer.bgroup = <span class="Constant">0</span> <span class="Statement">AND</span> ammodel.name = <span class="Constant">'LOGICAL SYSTEM'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> system <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::ipaddress ---------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- - Der Zugriff auf einen IP-Adressdatensatz wird dadurch eingeschraenkt,  -</span>
<span class="Comment">-- - das der Datensatz nur dann sichtbar ist, wenn auch das dazugehoerige   -</span>
<span class="Comment">-- - logische System fuer den Schnittstellen-User sichtbar ist.             -</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> ipaddress_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amnetworkcard.lnetworkcardid          id
   <span class="Special">FROM</span> AM2107.amnetworkcard
   JOIN system <span class="Special">on</span> system.<span class="Constant">&quot;lcomputerid&quot;</span>=amnetworkcard.lcompid;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> ipaddress <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amnetworkcard.lnetworkcardid          <span class="Constant">&quot;id&quot;</span>,
         amnetworkcard.tcpipaddress||
         decode(amnetworkcard.tcpipaddress,<span class="Special">NULL</span>,<span class="Constant">''</span>,
         decode(amnetworkcard.ipv6address,<span class="Special">NULL</span>,<span class="Constant">''</span>,
         <span class="Constant">', '</span>)) ||amnetworkcard.ipv6address          <span class="Special">AS</span> <span class="Constant">&quot;ipaddress&quot;</span>,
      amnetworkcard.tcpipaddress                     <span class="Special">AS</span> <span class="Constant">&quot;ipv4address&quot;</span>,
      amnetworkcard.ipv6address                      <span class="Special">AS</span> <span class="Constant">&quot;ipv6address&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      amnetworkcard.status                           <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      amnetworkcard.code                             <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amnetworkcard.subnetmask                       <span class="Special">AS</span> <span class="Constant">&quot;netmask&quot;</span>,
      amnetworkcard.dnsname                          <span class="Special">AS</span> <span class="Constant">&quot;dnsname&quot;</span>,
      amnetworkcard.dnsalias                         <span class="Special">AS</span> <span class="Constant">&quot;dnsalias&quot;</span>,
      amnetworkcard.<span class="Special">type</span>                             <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      amnetworkcard.description                      <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amnetworkcard.lcompid                          <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>,
      amnetworkcard.laccountnoid                     <span class="Special">AS</span> <span class="Constant">&quot;laccountnoid&quot;</span>,
      amnetworkcard.bdelete                          <span class="Special">AS</span> <span class="Constant">&quot;bdelete&quot;</span>,
      amnetworkcard.dtlastmodif                      <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad (amnetworkcard.lnetworkcardid,<span class="Constant">35</span>,<span class="Constant">'0'</span>)     <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amnetworkcard
      JOIN ipaddress_acl
         <span class="Special">ON</span> amnetworkcard.lnetworkcardid=ipaddress_acl.id
      JOIN AM2107.amcomputer
         <span class="Special">ON</span> amcomputer.lcomputerid = amnetworkcard.lcompid
      JOIN ( <span class="Statement">SELECT</span> amportfolio.* <span class="Special">FROM</span> AM2107.amportfolio
             <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span> ) amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> ipaddress <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::accountno ---------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> accountno_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> amtsiacctno.ltsiacctnoid id
   <span class="Special">FROM</span>
      AM2107.amtsiacctno
      join appl
         <span class="Special">ON</span> amtsiacctno.lapplicationid=appl.<span class="Constant">&quot;id&quot;</span>
   <span class="Statement">UNION</span>
   <span class="Statement">SELECT</span> amtsiacctno.ltsiacctnoid <span class="Constant">&quot;id&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amtsiacctno
      JOIN ipaddress
         <span class="Special">ON</span> amtsiacctno.ltsiacctnoid=ipaddress.<span class="Constant">&quot;laccountnoid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> accountno <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amtsiacctno.ltsiacctnoid              <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsiacctno.code                               <span class="Special">AS</span> <span class="Constant">&quot;accnoid&quot;</span>,
      amtsiacctno.accountno                          <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsiacctno.ctrlflag                           <span class="Special">AS</span> <span class="Constant">&quot;ctrlflag&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;conumber&quot;</span>,
      amtsiacctno.description                        <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amtsiacctno.lapplicationid                     <span class="Special">AS</span> <span class="Constant">&quot;lapplicationid&quot;</span>,
      amtsiacctno.lcostcenterid                      <span class="Special">AS</span> <span class="Constant">&quot;lcostcenterid&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amtsiacctno
      LEFT OUTER JOIN (
         <span class="Statement">SELECT</span> amcostcenter.* <span class="Special">FROM</span> AM2107.amcostcenter
         <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amtsiacctno.lcostcenterid = amcostcenter.lcostid
      JOIN accountno_acl
         <span class="Special">on</span> amtsiacctno.ltsiacctnoid=accountno_acl.id
   <span class="Special">WHERE</span>
      amtsiacctno.bdelete = <span class="Constant">0</span> <span class="Statement">AND</span> amtsiacctno.ltsiacctnoid &lt;&gt; <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> accountno <span class="Special">to</span> <span class="Special">public</span>;




<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnksharedstorage --------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Die Relationen zwischen logischem System und shared-Storage</span>
<span class="Comment">--   Componenten stehen jedem Schnittstellen-User zur Verfuegung. </span>
<span class="Comment">--   Es wird keine Filterung durchgefuehrt.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Comment">-- drop materialized view lnksharedstorage_acl_l0;</span>
<span class="Statement">CREATE</span> MATERIALIZED <span class="Special">VIEW</span> lnksharedstorage_acl_l0
  refresh complete <span class="Special">start</span> <span class="Special">with</span> <span class="Statement">sysdate</span>
  next trunc(<span class="Statement">sysdate</span>+<span class="Constant">1</span>)+<span class="Constant">6</span>/<span class="Constant">24</span>
  <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> storageportfolio.assettag             <span class="Special">AS</span> <span class="Constant">&quot;storageassetid&quot;</span>,
      storageportfolio.name                          <span class="Special">AS</span> <span class="Constant">&quot;storagename&quot;</span>,
      amtsiprovsto.lprovidedstorageid                <span class="Special">AS</span> <span class="Constant">&quot;storageid&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>,
      systemportfolio.assettag                       <span class="Special">AS</span> <span class="Constant">&quot;systemsystemid&quot;</span>,
      systemportfolio.name                           <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      amtsicustappl.code                             <span class="Special">AS</span> <span class="Constant">&quot;applid&quot;</span>,
      amtsicustappl.name                             <span class="Special">AS</span> <span class="Constant">&quot;applname&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiprovsto
      JOIN AM2107.amportfolio storageportfolio
         <span class="Special">ON</span> amtsiprovsto.lassetid = storageportfolio.lastid
      JOIN AM2107.amtsiprovstomounts
         <span class="Special">ON</span> amtsiprovsto.lprovidedstorageid=
            amtsiprovstomounts.lprovidedstorageid
      JOIN AM2107.amcomputer
         <span class="Special">ON</span> amtsiprovstomounts.lcomputerid = amcomputer.lcomputerid
      JOIN AM2107.amportfolio systemportfolio
         <span class="Special">ON</span> amcomputer.litemid = systemportfolio.lportfolioitemid
      JOIN AM2107.amtsirelportfappl
         <span class="Special">ON</span> systemportfolio.lportfolioitemid = amtsirelportfappl.lportfolioid
      JOIN AM2107.amtsicustappl
         <span class="Special">ON</span> amtsirelportfappl.lapplicationid = amtsicustappl.ltsicustapplid
   <span class="Special">WHERE</span> amtsiprovsto.bdelete = <span class="Constant">'0'</span>
      <span class="Statement">AND</span> amtsiprovstomounts.bdelete = <span class="Constant">'0'</span>
      <span class="Statement">AND</span> amtsirelportfappl.bdelete = <span class="Constant">0</span>;

<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharedstorage_acl_l0_i0
   <span class="Special">ON</span> lnksharedstorage_acl_l0 (<span class="Constant">&quot;storageassetid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharedstorage_acl_l0_i1
   <span class="Special">ON</span> lnksharedstorage_acl_l0 (<span class="Constant">&quot;lcomputerid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharedstorage_acl_l0_i2
   <span class="Special">ON</span> lnksharedstorage_acl_l0 (<span class="Constant">&quot;systemsystemid&quot;</span>) <span class="Special">online</span>;
<span class="Statement">CREATE</span> <span class="Special">INDEX</span> lnksharedstorage_acl_l0_i3
   <span class="Special">ON</span> lnksharedstorage_acl_l0 (<span class="Constant">&quot;applid&quot;</span>) <span class="Special">online</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksharedstorage_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> <span class="Constant">&quot;storageassetid&quot;</span> id
   <span class="Special">FROM</span> lnksharedstorage_acl_l0
      JOIN system
         <span class="Special">ON</span> lnksharedstorage_acl_l0.<span class="Constant">&quot;lcomputerid&quot;</span>=system.<span class="Constant">&quot;lcomputerid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksharedstorage <span class="Special">AS</span>
   <span class="Statement">SELECT</span> lnksharedstorage_acl_l0.*
   <span class="Special">FROM</span> lnksharedstorage_acl_l0
   JOIN lnksharedstorage_acl
      <span class="Special">ON</span> lnksharedstorage_acl.id=lnksharedstorage_acl_l0.<span class="Constant">&quot;storageassetid&quot;</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnksharedstorage <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::group -------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Assingmentgroup-Datensatz wird dadurch</span>
<span class="Comment">--   Eingeschraenkt, das der betreffende Schnittstellen-User in der</span>
<span class="Comment">--   IFACE_ACL aufgefuehrt sein muss. Ist dies der Fall, kann er alle</span>
<span class="Comment">--   Assignmentgroup Datensaetze abrufen.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> replace <span class="Special">VIEW</span> grp_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amemplgroup.barcode id
   <span class="Special">FROM</span> AM2107.amemplgroup
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>)
   <span class="Special">WHERE</span> amemplgroup.lgroupid &lt;&gt; <span class="Constant">0</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> replace <span class="Special">VIEW</span> grp <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amemplgroup.barcode                   <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amemplgroup.lgroupid                           <span class="Special">AS</span> <span class="Constant">&quot;lgroupid&quot;</span>,
      amemplgroup.name                               <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amemplgroup.name                               <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amemplgroup.bdelete                            <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amemplgroup.phone                              <span class="Special">AS</span> <span class="Constant">&quot;phone&quot;</span>,
      amemplgroup.lparentid                          <span class="Special">AS</span> <span class="Constant">&quot;parentid&quot;</span>,
      amemplgroup.lsupervid                          <span class="Special">AS</span> <span class="Constant">&quot;supervid&quot;</span>,
      amemplgroup.lscgroupid                         <span class="Special">AS</span> <span class="Constant">&quot;scgoupid&quot;</span>,
      amemplgroup.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amemplgroup.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>,
      amemplgroup.dtlastmodif                        <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amemplgroup
      JOIN grp_acl
         <span class="Special">ON</span> amemplgroup.barcode=grp_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> grp <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::user -------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Kontakt-Datensatz wird dadurch</span>
<span class="Comment">--   Eingeschraenkt, das der betreffende Schnittstellen-User in der</span>
<span class="Comment">--   IFACE_ACL aufgefuehrt sein muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> usr_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> amempldept.lempldeptid id
   <span class="Special">FROM</span> AM2107.amempldept
   <span class="Special">where</span> amempldept.lempldeptid&lt;&gt;<span class="Constant">0</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> usr <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amempldept.lempldeptid                <span class="Special">AS</span> <span class="Constant">&quot;lempldeptid&quot;</span>,
      amempldept.fullname                            <span class="Special">AS</span> <span class="Constant">&quot;acfullname&quot;</span>,
      amempldept.bdelete                             <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amempldept.userlogin                           <span class="Special">AS</span> <span class="Constant">&quot;loginname&quot;</span>,
      amempldept.contactid                           <span class="Special">AS</span> <span class="Constant">&quot;contactid&quot;</span>,
      amempldept.name                                <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amempldept.firstname                           <span class="Special">AS</span> <span class="Constant">&quot;firstname&quot;</span>,
      amempldept.name                                <span class="Special">AS</span> <span class="Constant">&quot;surname&quot;</span>,
      amempldept.firstname                           <span class="Special">AS</span> <span class="Constant">&quot;givenname&quot;</span>,
      amempldept.email                               <span class="Special">AS</span> <span class="Constant">&quot;email&quot;</span>,
      amempldept.ldapid                              <span class="Special">AS</span> <span class="Constant">&quot;ldapid&quot;</span>,
      amempldept.webpassword                         <span class="Special">AS</span> <span class="Constant">&quot;webpassword&quot;</span>,
      amempldept.idno                                <span class="Special">AS</span> <span class="Constant">&quot;idno&quot;</span>,
      amempldept.externalsystem                      <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amempldept.externalid                          <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amempldept
      JOIN usr_acl
         <span class="Special">on</span> amempldept.lempldeptid=usr_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> usr <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnkapplappl ------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Einen Anwendungsschnittstellen-Datensatz sieht an Schnittstellen-User</span>
<span class="Comment">--   dann, wenn er die betreffende Parent-Anwendung sieht.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkapplappl_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> amtsirelappl.lrelapplid id
   <span class="Special">FROM</span> AM2107.amtsirelappl
      JOIN appl
         <span class="Special">ON</span> amtsirelappl.lparentid=appl.<span class="Constant">&quot;id&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkapplappl <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      amtsirelappl.lrelapplid                        <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsicustappl.name                             <span class="Special">AS</span> <span class="Constant">&quot;child&quot;</span>,
      amtsicustappl.code                             <span class="Special">AS</span> <span class="Constant">&quot;child_applid&quot;</span>,
      amtsirelappl.<span class="Special">type</span>                              <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      amtsirelappl.lparentid                         <span class="Special">AS</span> <span class="Constant">&quot;lparentid&quot;</span>,
      amtsirelappl.lchildid                          <span class="Special">AS</span> <span class="Constant">&quot;lchildid&quot;</span>,
      amtsirelappl.bdelete                           <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amtsirelappl.dtlastmodif                       <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
      amtsirelappl.externalsystem                    <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amtsirelappl.externalid                        <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>,
      amtsirelappl.dtlastmodif                       <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad ( amtsirelappl.lrelapplid, <span class="Constant">35</span>, <span class="Constant">'0'</span>)       <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsirelappl
      JOIN lnkapplappl_acl
         <span class="Special">ON</span> lnkapplappl_acl.id=amtsirelappl.lrelapplid
      JOIN AM2107.amtsicustappl
         <span class="Special">ON</span> amtsirelappl.lchildid = amtsicustappl.ltsicustapplid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnkapplappl <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnkapplsystem -----------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf den Relationsdatensatz zwischen Anwendung und System</span>
<span class="Comment">--   wird dadurch eingeschraenkt, das der Schnittstellen-User einen</span>
<span class="Comment">--   Relationsdatensatz dann sieht, wenn er die darin aufgefuehrte</span>
<span class="Comment">--   Anwendung sehen darf.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkapplsystem_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> amtsirelportfappl.lrelportfapplid id
   <span class="Special">FROM</span> AM2107.amtsirelportfappl
   JOIN appl
      <span class="Special">ON</span> amtsirelportfappl.lapplicationid=appl.<span class="Constant">&quot;id&quot;</span>;


<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkapplsystem <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amtsirelportfappl.lrelportfapplid     <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsicustappl.code                             <span class="Special">AS</span> <span class="Constant">&quot;applid&quot;</span>,
      amportfolio.bdelete                            <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amtsirelportfappl.bactive                      <span class="Special">AS</span> <span class="Constant">&quot;isactive&quot;</span>,
      amtsicustappl.description                      <span class="Special">AS</span> <span class="Constant">&quot;appldescription&quot;</span>,
      amtsicustappl.usage                            <span class="Special">AS</span> <span class="Constant">&quot;usage&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;applconumber&quot;</span>,
      amcostcenter.field1                            <span class="Special">AS</span> <span class="Constant">&quot;applcodescription&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;altbc&quot;</span>,
      amtsicustappl.lservicecontactid                <span class="Special">AS</span> <span class="Constant">&quot;semid&quot;</span>,
      amtsicustappl.ltechnicalcontactid              <span class="Special">AS</span> <span class="Constant">&quot;tsmid&quot;</span>,
      amtsicustappl.lincidentagid                    <span class="Special">AS</span> <span class="Constant">&quot;lincidentagid&quot;</span>,
      sysamcostcenter.trimmedtitle                   <span class="Special">AS</span> <span class="Constant">&quot;sysconumber&quot;</span>,
      sysamcostcenter.field1                         <span class="Special">AS</span> <span class="Constant">&quot;syscodescription&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amcomputer.status                              <span class="Special">AS</span> <span class="Constant">&quot;sysstatus&quot;</span>,
      amcomputer.lcpunumber                          <span class="Special">AS</span> <span class="Constant">&quot;systemcpucount&quot;</span>,
      amcomputer.lcpuspeedmhz                        <span class="Special">AS</span> <span class="Constant">&quot;systemcpuspeed&quot;</span>,
      amcomputer.cputype                             <span class="Special">AS</span> <span class="Constant">&quot;systemcputype&quot;</span>,
      amcomputer.lProcCalcSpeed                      <span class="Special">AS</span> <span class="Constant">&quot;systemtpmc&quot;</span>,
      amcomputer.lmemorysizemb                       <span class="Special">AS</span> <span class="Constant">&quot;systemmemory&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;child&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      amcomputer.olaclasssystem                      <span class="Special">AS</span> <span class="Constant">&quot;systemola&quot;</span>,
      amcomputer.status                              <span class="Special">AS</span> <span class="Constant">&quot;systemstatus&quot;</span>,
      amtsirelportfappl.description                  <span class="Special">AS</span> <span class="Constant">&quot;comments&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;lsystemid&quot;</span>,
      amtsirelportfappl.lapplicationid               <span class="Special">AS</span> <span class="Constant">&quot;lparentid&quot;</span>,
      amtsirelportfappl.lportfolioid                 <span class="Special">AS</span> <span class="Constant">&quot;lchildid&quot;</span>,
      amtsirelportfappl.dtlastmodif                  <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
      amtsirelportfappl.externalsystem               <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amtsirelportfappl.externalid                   <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>,
      amtsirelportfappl.dtimport                     <span class="Special">AS</span> <span class="Constant">&quot;srcload&quot;</span>,
      amtsirelportfappl.dtlastmodif                  <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(amtsirelportfappl.lrelportfapplid,<span class="Constant">35</span>,<span class="Constant">'0'</span>) <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsirelportfappl
      JOIN lnkapplsystem_acl
         <span class="Special">ON</span> amtsirelportfappl.lrelportfapplid=lnkapplsystem_acl.id
      JOIN AM2107.amportfolio
         <span class="Special">ON</span> amtsirelportfappl.lportfolioid = amportfolio.lportfolioitemid
      JOIN AM2107.amcomputer
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid
      JOIN AM2107.amtsicustappl
         <span class="Special">ON</span> amtsirelportfappl.lapplicationid = amtsicustappl.ltsicustapplid
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.*
             <span class="Special">FROM</span> AM2107.amcostcenter
             <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amtsicustappl.lcostcenterid = amcostcenter.lcostid
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.*
             <span class="Special">FROM</span> AM2107.amcostcenter
             <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) sysamcostcenter
         <span class="Special">ON</span> amportfolio.lcostid = sysamcostcenter.lcostid
   <span class="Special">WHERE</span> amtsirelportfappl.lapplicationid = amtsicustappl.ltsicustapplid
      <span class="Statement">AND</span> amcomputer.status &lt;&gt; <span class="Constant">'out of operation'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnkapplsystem <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::osrelease ---------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen osrelease-Datensatz wird dadruch eingeschraenkt</span>
<span class="Comment">--   das der Schnittstellen-User in der IFACE_ACL aufgefuehrt sein muss.</span>
<span class="Comment">--   Ist dies der Fall, so sieht der Schnittstelle-User ALLE</span>
<span class="Comment">--   Betriebssystem-Datensaetze.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> osrelease_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amitemlistval.litemlistvalid      <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.amitemlistval
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> osrelease <span class="Special">AS</span>
<span class="Statement">SELECT</span>
   amitemlistval.litemlistvalid                   <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
   amitemlistval.value                            <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
   amitemlistval.dtlastmodif                      <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
   amitemlistval.dtlastmodif                      <span class="Special">AS</span> <span class="Constant">&quot;mdaterev&quot;</span>
<span class="Special">FROM</span> AM2107.amitemizedlist
   JOIN AM2107.amitemlistval
      <span class="Special">ON</span> amitemizedlist.litemlistid = amitemlistval.litemlistid
   JOIN osrelease_acl
      <span class="Special">ON</span> amitemlistval.litemlistvalid=osrelease_acl.id
<span class="Special">WHERE</span> amitemizedlist.identifier = <span class="Constant">'amOS'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> osrelease <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::asset -------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Asset Datensatz wird dadurch eingeschraenkt, das</span>
<span class="Comment">--   nur Datensaetze sichtbar sind, bei denen auch min. ein logisches</span>
<span class="Comment">--   fuer den betreffenden Schnittsttellen-User sichtbar ist.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> asset_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amportfolio.assettag               id
      <span class="Special">from</span> AM2107.amportfolio
      JOIN system
         <span class="Special">on</span> amportfolio.lportfolioitemid = system.<span class="Constant">&quot;lassetid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> asset <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> assetportfolio.assettag               <span class="Special">AS</span> <span class="Constant">&quot;assetid&quot;</span>,
      LOWER(amasset.status)                          <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      assetportfolio.assettag                        <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      assetportfolio.dtinvent                        <span class="Special">AS</span> <span class="Constant">&quot;install&quot;</span>,
      assetportfolio.lassignmentid                   <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;conumber&quot;</span>,
      amcostcenter.lcostid                           <span class="Special">AS</span> <span class="Constant">&quot;lcostcenterid&quot;</span>,
      assetportfolio.room                            <span class="Special">AS</span> <span class="Constant">&quot;room&quot;</span>,
      assetportfolio.place                           <span class="Special">AS</span> <span class="Constant">&quot;place&quot;</span>,
      amasset.cputype                                <span class="Special">AS</span> <span class="Constant">&quot;cputype&quot;</span>,
      decode(amasset.lmemorysizemb, <span class="Constant">0</span>, <span class="Special">NULL</span>,
             amasset.lmemorysizemb)                  <span class="Special">AS</span> <span class="Constant">&quot;memory&quot;</span>,
      decode(amasset.lcpunumber, <span class="Constant">0</span>,<span class="Special">NULL</span>,
             amasset.lcpunumber)                     <span class="Special">AS</span> <span class="Constant">&quot;cpucount&quot;</span>,
      decode(amasset.imaxnumberprocessors, <span class="Constant">0</span>,<span class="Special">NULL</span>,
             amasset.imaxnumberprocessors)           <span class="Special">AS</span> <span class="Constant">&quot;cpumaxsup&quot;</span>,
      decode(amasset.lcpuspeedmhz,<span class="Constant">0</span>,<span class="Special">NULL</span>,
             amasset.lcpuspeedmhz)                   <span class="Special">AS</span> <span class="Constant">&quot;cpuspeed&quot;</span>,
      decode(amasset.itotalnumberofcores,<span class="Constant">0</span>,<span class="Special">NULL</span>,
             amasset.itotalnumberofcores)            <span class="Special">AS</span> <span class="Constant">&quot;corecount&quot;</span>,
      amasset.serialno                               <span class="Special">AS</span> <span class="Constant">&quot;serialno&quot;</span>,
      amasset.inventoryno                            <span class="Special">AS</span> <span class="Constant">&quot;inventoryno&quot;</span>,
      amasset.lmaintlevelid                          <span class="Special">AS</span> <span class="Constant">&quot;maintlevelid&quot;</span>,
      amasset.seAcquModeTsi                          <span class="Special">AS</span> <span class="Constant">&quot;acqumode&quot;</span>,
      amasset.dstartacqu                             <span class="Special">AS</span> <span class="Constant">&quot;startacquisition&quot;</span>,
      amasset.mdeprcalc                              <span class="Special">AS</span> <span class="Constant">&quot;mdepr&quot;</span>,
      amasset.mmaintrate                             <span class="Special">AS</span> <span class="Constant">&quot;mmaint&quot;</span>,
      amasset.maintcond                              <span class="Special">AS</span> <span class="Constant">&quot;maitcond&quot;</span>,
      assetportfolio.llocaid                         <span class="Special">AS</span> <span class="Constant">&quot;locationid&quot;</span>,
      assetportfolio.lportfolioitemid                <span class="Special">AS</span> <span class="Constant">&quot;lassetid&quot;</span>,
      amasset.lastid                                 <span class="Special">AS</span> <span class="Constant">&quot;lassetassetid&quot;</span>,
      assetportfolio.lmodelid                        <span class="Special">AS</span> <span class="Constant">&quot;lmodelid&quot;</span>,
      assetportfolio.dtlastmodif                     <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(assetportfolio.assettag,<span class="Constant">35</span>,<span class="Constant">'0'</span>)           <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>,
      assetportfolio.bdelete                         <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      assetportfolio.dtcreation                      <span class="Special">AS</span> <span class="Constant">&quot;cdate&quot;</span>,
      assetportfolio.dtlastmodif                     <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
      assetportfolio.externalsystem                  <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      assetportfolio.externalid                      <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amasset
      JOIN AM2107.amportfolio assetportfolio
         <span class="Special">ON</span> assetportfolio.assettag = amasset.assettag
      JOIN asset_acl
         <span class="Special">ON</span> assetportfolio.assettag=asset_acl.id
      JOIN AM2107.ammodel
         <span class="Special">ON</span> assetportfolio.lmodelid = ammodel.lmodelid
      LEFT OUTER JOIN AM2107.amlocation
         <span class="Special">ON</span> assetportfolio.llocaid = amlocation.llocaid
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.*
            <span class="Special">FROM</span> AM2107.amcostcenter
            <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amasset.lsendercostcenterid = amcostcenter.lcostid
      LEFT OUTER JOIN AM2107.amnature
         <span class="Special">ON</span> ammodel.lnatureid = amnature.lnatureid
   <span class="Special">WHERE</span> ammodel.name <span class="Statement">NOT</span> <span class="Statement">IN</span> (<span class="Constant">'LOGICAL SYSTEM'</span>,<span class="Constant">'CLUSTER'</span>,<span class="Constant">'DB-INSTANCE'</span>);

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> asset <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnkusergroup ------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Die Relation zwischen User und Assignmentgroup ist dann fuer einen</span>
<span class="Comment">--   Schnittstellen-User einsehbar, wenn er die zugehorige Assignmentgroup</span>
<span class="Comment">--   sehen darf.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkusergroup_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> concat (amrelemplgrp.lgroupid,
         concat ( <span class="Constant">'-'</span>,amrelemplgrp.lempldeptid))     <span class="Special">AS</span> id
   <span class="Special">FROM</span>
      AM2107.amrelemplgrp
      JOIN grp
         <span class="Special">ON</span> amrelemplgrp.lgroupid=grp.<span class="Constant">&quot;lgroupid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkusergroup <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> concat (amrelemplgrp.lgroupid,
         concat ( <span class="Constant">'-'</span>,amrelemplgrp.lempldeptid))     <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amrelemplgrp.lempldeptid                       <span class="Special">AS</span> <span class="Constant">&quot;lempldeptid&quot;</span>,
      amrelemplgrp.lgroupid                          <span class="Special">AS</span> <span class="Constant">&quot;lgroupid&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amrelemplgrp
      JOIN lnkusergroup_acl
         <span class="Special">ON</span> concat(amrelemplgrp.lgroupid,concat(<span class="Constant">'-'</span>,amrelemplgrp.lempldeptid))=
            lnkusergroup_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnkusergroup <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::costcenter --------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Kontierungs-Datensatz wird explizit NICHT</span>
<span class="Comment">--   durch die Filter in der IFACE_ACL eingeschraenkt (der Schnittstellen</span>
<span class="Comment">--   User muss darin nur mit min. einem Datensatz vorhanden sein), da</span>
<span class="Comment">--   dadurch Informationen zu Kontierungsobjekten zugaenglich werden </span>
<span class="Comment">--   muessen, um z.B. auch Ansprechparnter ausfindig machen zu koennen.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> costcenter_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amcostcenter.lcostid              <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.amcostcenter
      join IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> costcenter <span class="Special">AS</span>
   <span class="Statement">SELECT</span> amcostcenter.lcostid                       <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amcostcenter.title                             <span class="Special">AS</span> <span class="Constant">&quot;untrimmedname&quot;</span>,
      decode(amcostcenter.flag9,<span class="Constant">'X'</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)           <span class="Special">AS</span> <span class="Constant">&quot;islocked&quot;</span>,
      amcostcenter.code                              <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amcostcenter.field1                            <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;bc&quot;</span>,
      amcostcenter.orgunit                           <span class="Special">AS</span> <span class="Constant">&quot;orgunit&quot;</span>,
      (
         <span class="Statement">SELECT</span> decode(COUNT(*),<span class="Constant">0</span>,<span class="Constant">0</span>,<span class="Constant">1</span>)
         <span class="Special">FROM</span> AM2107.amportfolio p1
            JOIN AM2107.amcomputer c1
               <span class="Special">ON</span> p1.lportfolioitemid = c1.litemid
         <span class="Special">WHERE</span> p1.lcostid = amcostcenter.lcostid
           <span class="Statement">AND</span> LOWER(c1.status)!=<span class="Constant">'out of operation'</span>) <span class="Special">AS</span> <span class="Constant">&quot;usedbyactivesystems&quot;</span>,
      amcostcenter.ictonr                            <span class="Special">AS</span> <span class="Constant">&quot;ictonr&quot;</span>,
      amcostcenter.bdelete                           <span class="Special">AS</span> <span class="Constant">&quot;deleted&quot;</span>,
      amcostcenter.norsolutionmodel                  <span class="Special">AS</span> <span class="Constant">&quot;norsolutionmodel&quot;</span>,
      amcostcenter.norinstructiontyp                 <span class="Special">AS</span> <span class="Constant">&quot;norinstructiontyp&quot;</span>,
      amcostcenter.lleadingdeliverymanagerid         <span class="Special">AS</span> <span class="Constant">&quot;delmgrid&quot;</span>,
      amcostcenter.lproductionplanningossid          <span class="Special">AS</span> <span class="Constant">&quot;productionplanningossid&quot;</span>,
      amcostcenter.lcustomerlinkid                   <span class="Special">AS</span> <span class="Constant">&quot;lcustomerid&quot;</span>,
      amtsiaccsecunit.identifier                     <span class="Special">AS</span> <span class="Constant">&quot;customerlink&quot;</span>,
      amtsisclocations.sclocationid                  <span class="Special">AS</span> <span class="Constant">&quot;defsclocationid&quot;</span>,
      amcostcenter.lservicemanagerid                 <span class="Special">AS</span> <span class="Constant">&quot;semid&quot;</span>,
      decode ( amcostcenter.hier0id,<span class="Constant">''</span>,<span class="Constant">'-'</span>,
         amcostcenter.hier0id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier1id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier1id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier2id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier2id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier3id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier3id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier4id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier4id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier5id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier5id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier6id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier6id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier7id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier7id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier8id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier8id)
      || <span class="Constant">'.'</span> || decode ( amcostcenter.hier9id,
         <span class="Constant">''</span>,<span class="Constant">'-'</span>,amcostcenter.hier9id)                <span class="Special">AS</span> <span class="Constant">&quot;saphier&quot;</span>,
      amcostcenter.hier0id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier0id&quot;</span>,
      amcostcenter.hier1id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier1id&quot;</span>,
      amcostcenter.hier2id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier2id&quot;</span>,
      amcostcenter.hier3id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier3id&quot;</span>,
      amcostcenter.hier4id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier4id&quot;</span>,
      amcostcenter.hier5id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier5id&quot;</span>,
      amcostcenter.hier6id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier6id&quot;</span>,
      amcostcenter.hier7id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier7id&quot;</span>,
      amcostcenter.hier8id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier8id&quot;</span>,
      amcostcenter.hier9id                           <span class="Special">AS</span> <span class="Constant">&quot;saphier9id&quot;</span>,
      amcostcenter.externalsystem                    <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amcostcenter.externalid                        <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>,
      amcostcenter.dtimport                          <span class="Special">AS</span> <span class="Constant">&quot;srcload&quot;</span>,
      amcostcenter.dtlastmodif                       <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amcostcenter
      JOIN costcenter_acl
         <span class="Special">ON</span> amcostcenter.lcostid=costcenter_acl.id
      LEFT OUTER JOIN AM2107.amtsiaccsecunit
         <span class="Special">ON</span> amcostcenter.lcustomerlinkid = amtsiaccsecunit.lunitid
      LEFT OUTER JOIN AM2107.amtsisclocations
         <span class="Special">ON</span> amtsiaccsecunit.ldefaultsclocationid = amtsisclocations.ltsisclocationsid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> costcenter <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::customer ----------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen CustomerLink-Datensatz wird dadurch</span>
<span class="Comment">--   Eingeschraenkt, das der betreffende Schnittstellen-User in der</span>
<span class="Comment">--   IFACE_ACL mit Zugriff auf den bestimmten CustomerLink aufgefuehrt</span>
<span class="Comment">--   sein muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> customer_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsiaccsecunit.lunitid           <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.amtsiaccsecunit
      JOIN IFACE_ACL acl
         <span class="Special">ON</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>) <span class="Statement">and</span>
             (acl.assignment <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (acl.acctno <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (amtsiaccsecunit.identifier <span class="Statement">like</span> acl.customerlnk
                <span class="Statement">or</span> acl.customerlnk <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
            (acl.customerlnk <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.acctno <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.assignment <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> customer <span class="Special">AS</span>
   <span class="Statement">SELECT</span> amtsiaccsecunit.lunitid                    <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsiaccsecunit.identifier                     <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsiaccsecunit.description                    <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amtsiaccsecunit.ldeliverymanagerid             <span class="Special">AS</span> <span class="Constant">&quot;delmgrid&quot;</span>,
      amtsiaccsecunit.code                           <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amtsiaccsecunit.ldefaultsclocationid           <span class="Special">AS</span> <span class="Constant">&quot;defaultsclocationid&quot;</span>,
      amtsiaccsecunit.dtlastmodif                    <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiaccsecunit
      JOIN customer_acl
         <span class="Special">ON</span> amtsiaccsecunit.lunitid=customer_acl.id
   <span class="Special">WHERE</span> amtsiaccsecunit.lunitid &lt;&gt; <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> customer <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::dlvpartner --------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Delivery-Partner eines Kontierungsobjektes</span>
<span class="Comment">--   wird dann gewaehrt, wenn der Zugriff auf das betreffende</span>
<span class="Comment">--   Kontierungsobjekt erlaubt ist.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> dlvpartner_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amtsidlvpartner.ldeliverypartnerid    <span class="Special">AS</span> id
   <span class="Special">FROM</span>
      AM2107.amtsidlvpartner
         JOIN costcenter_acl
           <span class="Special">ON</span> amtsidlvpartner.lcostcenterid = costcenter_acl.id;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> dlvpartner <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amtsidlvpartner.ldeliverypartnerid    <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsidlvpartner.ldeliverymanagementid          <span class="Special">AS</span> <span class="Constant">&quot;ldeliverymanagementid&quot;</span>,
      amtsidlvpartner.description                    <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amtsidlvpartner.ldeliverymanagerid             <span class="Special">AS</span> <span class="Constant">&quot;delmgrid&quot;</span>,
      amtsidlvpartner.ldeputydeliverymanagerid       <span class="Special">AS</span> <span class="Constant">&quot;delmgr2id&quot;</span>,
      amtsidlvpartner.lcommentid                     <span class="Special">AS</span> <span class="Constant">&quot;lcommentid&quot;</span>,
      amtsidlvpartner.dtlastmodif <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amtsidlvpartner
         JOIN AM2107.amcostcenter
           <span class="Special">ON</span> amtsidlvpartner.lcostcenterid = amcostcenter.lcostid
   <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>
      <span class="Statement">AND</span> amtsidlvpartner.bdelete = <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> dlvpartner <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::location ----------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Standort-Datensaetze wird dadurch eingefschrankt</span>
<span class="Comment">--   das der Schnittstellen-User in der IFACE_ACL aufgefuert sein muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> location_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amlocation.llocaid      <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.amlocation
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> location <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amlocation.llocaid                    <span class="Special">AS</span> <span class="Constant">&quot;locationid&quot;</span>,
      amlocation.fullname                            <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amlocation.address1                            <span class="Special">AS</span> <span class="Constant">&quot;address1&quot;</span>,
      amlocation.zip                                 <span class="Special">AS</span> <span class="Constant">&quot;zipcode&quot;</span>,
      amcountry.isocode                              <span class="Special">AS</span> <span class="Constant">&quot;country&quot;</span>,
      amlocation.city                                <span class="Special">AS</span> <span class="Constant">&quot;location&quot;</span>,
      amlocation.locationtype                        <span class="Special">AS</span> <span class="Constant">&quot;locationtype&quot;</span>,
      amlocation.name                                <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amlocation.barcode                             <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amlocation.dtlastmodif                         <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(amlocation.llocaid,<span class="Constant">35</span>,<span class="Constant">'0'</span>)                <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>,
      amlocation.dtlastmodif                         <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amlocation
      JOIN location_acl
         <span class="Special">ON</span> amlocation.llocaid=location_acl.id
      LEFT OUTER JOIN AM2107.amcountry
         <span class="Special">ON</span> amlocation.lcountryid = amcountry.lcountryid
   <span class="Special">WHERE</span> amlocation.bdelete = <span class="Constant">0</span> <span class="Statement">AND</span> amlocation.llocaid &gt; <span class="Constant">0</span>
      <span class="Statement">AND</span> amlocation.llocaid <span class="Special">IS</span> <span class="Statement">NOT</span> <span class="Special">NULL</span> <span class="Statement">AND</span> amlocation.dtlastmodif <span class="Special">IS</span> <span class="Statement">NOT</span> <span class="Special">NULL</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> location <span class="Special">to</span> <span class="Special">public</span>;

<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnksystemsoftware -------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Software-Installationsdatensaetze wird dadurch</span>
<span class="Comment">--   eingeschraenkt, das nur die Software-Installationen sichtbar sind,</span>
<span class="Comment">--   fuer die auch die betreffenden Systeme sichtbar sind.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksystemsoftware_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amportfolio.assettag                  <span class="Special">AS</span> id
   <span class="Special">from</span> AM2107.amportfolio
      JOIN system
         <span class="Special">ON</span> amportfolio.lparentid=system.<span class="Constant">&quot;lportfolioitemid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnksystemsoftware <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amportfolio.assettag                  <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      ammodel.name                                   <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amsoftinstall.lusecount                        <span class="Special">AS</span> <span class="Constant">&quot;quantity&quot;</span>,
      ammodel.versionlevel                           <span class="Special">AS</span> <span class="Constant">&quot;version&quot;</span>,
      amsoftinstall.folder                           <span class="Special">AS</span> <span class="Constant">&quot;instpath&quot;</span>,
      amportfolio.lparentid                          <span class="Special">AS</span> <span class="Constant">&quot;lparentid&quot;</span>,
      amsoftinstall.llicenseid                       <span class="Special">AS</span> <span class="Constant">&quot;llicense&quot;</span>,
      amportfolio.dtcreation                         <span class="Special">AS</span> <span class="Constant">&quot;cdate&quot;</span>,
      amsoftinstall.dtlastmodif                      <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amportfolio
      JOIN lnksystemsoftware_acl
         <span class="Special">ON</span> amportfolio.assettag=lnksystemsoftware_acl.id
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
      LEFT OUTER JOIN AM2107.amnature
         <span class="Special">ON</span> ammodel.lnatureid = amnature.lnatureid
      JOIN AM2107.amsoftinstall
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amsoftinstall.litemid
   <span class="Special">WHERE</span> ammodel.certification = <span class="Constant">'CSS'</span> <span class="Statement">AND</span> amnature.name = <span class="Constant">'SW-INSTALLATION'</span>
      <span class="Statement">AND</span> amportfolio.bdelete = <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnksystemsoftware <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::model -------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Model-Datensaetze wird dadurch eingeschraenkt</span>
<span class="Comment">--   das der Schnittstellen-User in der IFACE_ACL aufgefuert sein muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> model_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> assetmodel.lmodelid                        <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.ammodel assetmodel
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>)
   <span class="Special">WHERE</span> assetmodel.lmodelid&lt;&gt;<span class="Constant">'0'</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> model <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      assetmodel.lmodelid                            <span class="Special">AS</span> <span class="Constant">&quot;lmodelid&quot;</span>,
      assetmodel.name                                <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      assetmodel.barcode                             <span class="Special">AS</span> <span class="Constant">&quot;barcode&quot;</span>,
      amnature.name                                  <span class="Special">AS</span> <span class="Constant">&quot;nature&quot;</span>,
      ambrand.name                                   <span class="Special">AS</span> <span class="Constant">&quot;vendor&quot;</span>,
      assetpowerinput.powerinput                     <span class="Special">AS</span> <span class="Constant">&quot;assetpowerinput&quot;</span>,
      assetmodel.dtlastmodif                         <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(assetmodel.lmodelid,<span class="Constant">35</span>,<span class="Constant">'0'</span>)               <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>,
      assetmodel.dtlastmodif                         <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.ammodel assetmodel
      JOIN model_acl
         <span class="Special">ON</span> assetmodel.lmodelid=model_acl.id
      LEFT OUTER JOIN AM2107.amnature
         <span class="Special">ON</span> assetmodel.lnatureid = amnature.lnatureid
      LEFT OUTER JOIN (
            <span class="Statement">SELECT</span> amfvmodel.fval PowerInput,lmodelid
            <span class="Special">FROM</span> AM2107.amfvmodel
               JOIN AM2107.amfeature
                  <span class="Special">ON</span> amfvmodel.lfeatid = amfeature.lfeatid
            <span class="Special">WHERE</span> amfeature.sqlname = <span class="Constant">'PowerInput'</span>) assetpowerinput
         <span class="Special">ON</span> assetmodel.lmodelid = assetpowerinput.lmodelid
      LEFT OUTER JOIN AM2107.ambrand
         <span class="Special">ON</span> assetmodel.lbrandid = ambrand.lbrandid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> model <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::swinstance --------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Software-Instanz Datensatz wird dadurch</span>
<span class="Comment">--   eingeschraenkt, dass der betreffende Schnittstellen-User ueber die</span>
<span class="Comment">--   IFACE_ACL entweder den Zugriff auf den Buchungskreis, die</span>
<span class="Comment">--   Assignmentgroup der Instanz oder den aus  dem Kontierungsobjekt</span>
<span class="Comment">--   resultierenden Customer-Link haben muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> swinstance_acl <span class="Special">AS</span>
   <span class="Statement">select</span> <span class="Statement">distinct</span> amtsiswinstance.lportfolioid   <span class="Special">AS</span> id
   <span class="Special">FROM</span> AM2107.amtsiswinstance
      JOIN (<span class="Statement">SELECT</span> amportfolio.* <span class="Special">FROM</span> AM2107.amportfolio
             <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span>) amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amtsiswinstance.lportfolioid
      left outer join AM2107.amemplgroup assigrp
         <span class="Special">on</span> amportfolio.lassignmentid = assigrp.lgroupid
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.* <span class="Special">FROM</span> AM2107.amcostcenter
            <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
      LEFT OUTER JOIN AM2107.amtsiaccsecunit customerlnk
            <span class="Special">on</span> amcostcenter.lcustomerlinkid=customerlnk.lunitid
      <span class="Special">ON</span>  amportfolio.lcostid = amcostcenter.lcostid
      join IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>) <span class="Statement">and</span>
             ( assigrp.name <span class="Statement">like</span> acl.assignment
               <span class="Statement">or</span> acl.assignment <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (amcostcenter.acctno <span class="Statement">like</span> acl.acctno
                <span class="Statement">or</span> acl.acctno <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (customerlnk.identifier <span class="Statement">like</span> acl.customerlnk
                <span class="Statement">or</span> acl.customerlnk <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
            (acl.customerlnk <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.acctno <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.assignment <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> swinstance <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> concat(amportfolio.name,
      concat(<span class="Constant">' ('</span>,concat(amportfolio.assettag, <span class="Constant">')'</span>)))  <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      concat(amportfolio.name,concat(<span class="Constant">' ('</span>,concat(amportfolio.code,
               <span class="Constant">')'</span>)))                                <span class="Special">AS</span> <span class="Constant">&quot;scfullname&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;swinstanceid&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amportfolio.lincidentagid                      <span class="Special">AS</span> <span class="Constant">&quot;lincidentagid&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;conumber&quot;</span>,
      amcostcenter.lcostid                           <span class="Special">AS</span> <span class="Constant">&quot;lcostcenterid&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;altbc&quot;</span>,
      amtsiswinstance.status                         <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      amtsiswinstance.monitoringname                 <span class="Special">AS</span> <span class="Constant">&quot;monname&quot;</span>,
      amtsiswinstance.lportfolioid                   <span class="Special">AS</span> <span class="Constant">&quot;portfolioid&quot;</span>,
      amportfolio.dtlastmodif                        <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>,
      amportfolio.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amportfolio.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiswinstance
      JOIN swinstance_acl
         <span class="Special">ON</span> amtsiswinstance.lportfolioid=swinstance_acl.id
      JOIN (<span class="Statement">SELECT</span> amportfolio.* <span class="Special">FROM</span> AM2107.amportfolio
             <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span>) amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amtsiswinstance.lportfolioid
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.* <span class="Special">FROM</span> AM2107.amcostcenter
            <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span>  amportfolio.lcostid = amcostcenter.lcostid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> swinstance <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::sclocation --------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die ServiceCenter Location Datensaetze wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> sclocation_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsisclocations.ltsisclocationsid id
   <span class="Special">FROM</span> AM2107.amtsisclocations
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> sclocation <span class="Special">AS</span>
   <span class="Statement">SELECT</span>  amtsisclocations.ltsisclocationsid        <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsisclocations.sclocationname                <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsisclocations.companytxt                    <span class="Special">AS</span> <span class="Constant">&quot;company&quot;</span>,
      amtsisclocations.subcompany                    <span class="Special">AS</span> <span class="Constant">&quot;subcompany&quot;</span>,
      amtsisclocations.sclocationid                  <span class="Special">AS</span> <span class="Constant">&quot;sclocationid&quot;</span>,
      amtsisclocations.dtlastmodif                   <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsisclocations
      JOIN sclocation_acl
         <span class="Special">ON</span> amtsisclocations.ltsisclocationsid=sclocation_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> sclocation <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::autodiscsystem ----------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die logisches System im AutoDiscovery wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscsystem_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsiautodiscovery.lautodiscoveryid id
   <span class="Special">FROM</span> AM2107.amtsiautodiscovery
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscsystem <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      amtsiautodiscovery.lautodiscoveryid            <span class="Special">AS</span> <span class="Constant">&quot;systemdiscoveryid&quot;</span>,
      amtsiautodiscovery.name                        <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      amtsiautodiscovery.name                        <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amtsiautodiscovery.assettag                    <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      amtsiautodiscovery.model                       <span class="Special">AS</span> <span class="Constant">&quot;model&quot;</span>,
      amtsiautodiscovery.os                          <span class="Special">AS</span> <span class="Constant">&quot;osrelease&quot;</span>,
      amtsiautodiscovery.lmemorymb                   <span class="Special">AS</span> <span class="Constant">&quot;memory&quot;</span>,
      amtsiautodiscovery.lcpucount                   <span class="Special">AS</span> <span class="Constant">&quot;physcpucount&quot;</span>,
      amtsiautodiscovery.cputype                     <span class="Special">AS</span> <span class="Constant">&quot;cputype&quot;</span>,
      amtsiautodiscovery.lcpuspeedmhz                <span class="Special">AS</span> <span class="Constant">&quot;cpuspeed&quot;</span>,
      amtsiautodiscovery.itotalnumberofcores         <span class="Special">AS</span> <span class="Constant">&quot;independcpucount&quot;</span>,
      amtsiautodiscovery.itotalnumberofcores *
         amtsiautodiscovery.smt                      <span class="Special">AS</span> <span class="Constant">&quot;cpucount&quot;</span>,
      amtsiautodiscovery.serialno                    <span class="Special">AS</span> <span class="Constant">&quot;serialno&quot;</span>,
      amtsiautodiscovery.dtscandate                  <span class="Special">AS</span> <span class="Constant">&quot;scandate&quot;</span>,
      amtsiautodiscovery.source                      <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiautodiscovery
      JOIN autodiscsystem_acl
         <span class="Special">ON</span> amtsiautodiscovery.lautodiscoveryid=autodiscsystem_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> autodiscsystem <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::autodiscipaddress -------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die AutoDiscovery IP Daten wird dadurch freigegen,</span>
<span class="Comment">--   dass der Schnittstellen-User Zugriff auf den betreffenden </span>
<span class="Comment">--   Datensatz fuer das AutoDiscovery-Logisches System hat.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscipaddress_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> <span class="Constant">&quot;systemdiscoveryid&quot;</span> id
   <span class="Special">FROM</span> autodiscsystem;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscipaddress <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      amtsiautodiscinterfaces.linterfaceid           <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsiautodiscinterfaces.ipaddress              <span class="Special">AS</span> <span class="Constant">&quot;address&quot;</span>,
      amtsiautodiscinterfaces.physicaladdress        <span class="Special">AS</span> <span class="Constant">&quot;physicaladdress&quot;</span>,
      amtsiautodiscinterfaces.lsystemautodiscid      <span class="Special">AS</span> <span class="Constant">&quot;systemautodiscid&quot;</span>,
      amtsiautodiscinterfaces.dtscan                 <span class="Special">AS</span> <span class="Constant">&quot;scandate&quot;</span>,
      amtsiautodiscinterfaces.source                 <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiautodiscinterfaces
      JOIN autodiscipaddress_acl
         <span class="Special">ON</span> amtsiautodiscinterfaces.lsystemautodiscid=autodiscipaddress_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> autodiscipaddress <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::autodiscsoftware --------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die AutoDiscovery Software Daten wird dadurch freigegen,</span>
<span class="Comment">--   dass der Schnittstellen-User Zugriff auf den betreffenden </span>
<span class="Comment">--   Datensatz fuer das AutoDiscovery-Logisches System hat.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscsoftware_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> <span class="Constant">&quot;systemdiscoveryid&quot;</span> id
   <span class="Special">FROM</span> autodiscsystem;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> autodiscsoftware <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      amtsiautodiscsw.ladswid                        <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsiautodiscsw.productname                    <span class="Special">AS</span> <span class="Constant">&quot;software&quot;</span>,
      amtsiautodiscsw.manufacturer                   <span class="Special">AS</span> <span class="Constant">&quot;producer&quot;</span>,
      amtsiautodiscsw.version                        <span class="Special">AS</span> <span class="Constant">&quot;version&quot;</span>,
      amtsiautodiscsw.path                           <span class="Special">AS</span> <span class="Constant">&quot;path&quot;</span>,
      amtsiautodiscsw.lautodiscsystemid              <span class="Special">AS</span> <span class="Constant">&quot;systemautodiscid&quot;</span>,
      amtsiautodiscsw.dtscan                         <span class="Special">AS</span> <span class="Constant">&quot;scandate&quot;</span>,
      amtsiautodiscsw.source                         <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiautodiscsw
      JOIN autodiscsoftware_acl
         <span class="Special">ON</span> amtsiautodiscsw.lautodiscsystemid=autodiscsoftware_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> autodiscsoftware <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itfarm ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Serverfarm wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarm_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> clu.litemid            <span class="Special">AS</span> id
   <span class="Special">FROM</span>
      AM2107.amcomputer sys
      JOIN AM2107.amportfolio sysportfolio
         <span class="Special">ON</span> sysportfolio.lportfolioitemid = sys.litemid
      JOIN AM2107.amportfolio assportfolio
         <span class="Special">ON</span> assportfolio.Lportfolioitemid = sysportfolio.lparentid
      JOIN AM2107.amasset ass
         <span class="Special">ON</span> assportfolio.assettag = ass.assettag
      JOIN AM2107.amcomputer clu
         <span class="Special">ON</span> sys.lparentid = clu.lcomputerid
      JOIN AM2107.amportfolio cluportfolio
         <span class="Special">ON</span> cluportfolio.assettag = clu.assettag
      JOIN IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>)
   <span class="Special">WHERE</span> sysportfolio.usage <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
      <span class="Statement">AND</span> sys.status &lt;&gt; <span class="Constant">'out of operation'</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarm <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> clu.litemid                           <span class="Special">AS</span> <span class="Constant">&quot;lfarmid&quot;</span>,
      cluportfolio.name                              <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      clu.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;clusterid&quot;</span>,
      clu.status                                     <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amcomputer sys
      JOIN AM2107.amportfolio sysportfolio
         <span class="Special">ON</span> sysportfolio.lportfolioitemid = sys.litemid
      JOIN AM2107.amportfolio assportfolio
         <span class="Special">ON</span> assportfolio.Lportfolioitemid = sysportfolio.lparentid
      JOIN AM2107.amasset ass
         <span class="Special">ON</span> assportfolio.assettag = ass.assettag
      JOIN AM2107.amcomputer clu
         <span class="Special">ON</span> sys.lparentid = clu.lcomputerid
      JOIN itfarm_acl
         <span class="Special">ON</span> clu.litemid=itfarm_acl.id
      JOIN AM2107.amportfolio cluportfolio
         <span class="Special">ON</span> cluportfolio.assettag = clu.assettag
   <span class="Special">WHERE</span> sysportfolio.usage <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
      <span class="Statement">AND</span> sys.status &lt;&gt; <span class="Constant">'out of operation'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itfarm <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::schain ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Serviceketten wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> schain_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsisalessrvcpkg.lsrvcpkgid      <span class="Special">AS</span> id
   <span class="Special">FROM</span>
      AM2107.amtsisalessrvcpkg
      JOIN IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> schain <span class="Special">AS</span>
   <span class="Statement">SELECT</span> amtsisalessrvcpkg.lsrvcpkgid          <span class="Special">AS</span> <span class="Constant">&quot;schainid&quot;</span>,
      amtsisalessrvcpkg.code                         <span class="Special">AS</span> <span class="Constant">&quot;code&quot;</span>,
      amtsisalessrvcpkg.name                         <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amtsisalessrvcpkg.lcommentid                   <span class="Special">AS</span> <span class="Constant">&quot;lcommentid&quot;</span>,
      amcomment.memcomment                           <span class="Special">AS</span> <span class="Constant">&quot;comments&quot;</span>,
      amtsisalessrvcpkg.dtlastmodif                  <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(amtsisalessrvcpkg.code,<span class="Constant">35</span>,<span class="Constant">'0'</span>)            <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>,
      amtsisalessrvcpkg.dtlastmodif                  <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsisalessrvcpkg
      JOIN schain_acl
         <span class="Special">ON</span> amtsisalessrvcpkg.lsrvcpkgid=schain_acl.id
      LEFT OUTER JOIN AM2107.amcomment
         <span class="Special">ON</span> amtsisalessrvcpkg.lcommentid=amcomment.lcommentid
   <span class="Special">WHERE</span> amtsisalessrvcpkg.bdelete = <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> schain <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::lnkschain ---------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Serviceketten Verknuepfungen wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User die betreffende Servicekette</span>
<span class="Comment">--   sehen muss, um den Zugriff auf den Verknuepfungsdatensatz zu bekommen.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkschain_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> <span class="Constant">&quot;schainid&quot;</span> id
   <span class="Special">FROM</span>  schain;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> lnkschain <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> schainrel.id                          <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      schainrel.lsspid                               <span class="Special">AS</span> <span class="Constant">&quot;lsspid&quot;</span>,
      schainrel.itemid                               <span class="Special">AS</span> <span class="Constant">&quot;itemid&quot;</span>,
      schainrel.itemname                             <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      schainrel.itemclass                            <span class="Special">AS</span> <span class="Constant">&quot;class&quot;</span>,
      schainrel.dtlastmodif                          <span class="Special">AS</span> <span class="Constant">&quot;replkeypri&quot;</span>,
      lpad(schainrel.lsspid,<span class="Constant">35</span>,<span class="Constant">'0'</span>)                  <span class="Special">AS</span> <span class="Constant">&quot;replkeysec&quot;</span>,
      schainrel.dtlastmodif                          <span class="Special">AS</span> <span class="Constant">&quot;mdate&quot;</span>
   <span class="Special">FROM</span> (<span class="Statement">SELECT</span>
            <span class="Constant">'P'</span> || amtsirelsspport.LTSIRELSSPPORTID id,
            amtsirelsspport.lsspid lsspid,
            CAST(amportfolio.assettag  <span class="Special">AS</span> <span class="Type">VARCHAR2</span> (<span class="Constant">40</span>))    itemid,
            CAST(amportfolio.name  <span class="Special">AS</span> <span class="Type">VARCHAR2</span> (<span class="Constant">4000</span>))      itemname,
            CAST(amportfolio.dfe547e741   <span class="Special">AS</span> <span class="Type">VARCHAR2</span> (<span class="Constant">80</span>)) itemclass,
            <span class="Special">NULL</span>                                            itemdataobj,
            amtsirelsspport.dtlastmodif
         <span class="Special">FROM</span> AM2107.amtsirelsspport, AM2107.amportfolio
         <span class="Special">WHERE</span>
            amtsirelsspport.lportfolioid = amportfolio.lportfolioitemid
            <span class="Statement">AND</span> amportfolio.bdelete = <span class="Constant">0</span>
            <span class="Statement">AND</span> amtsirelsspport.bdelete = <span class="Constant">0</span>
            <span class="Statement">UNION</span> <span class="Statement">ALL</span>
         <span class="Statement">SELECT</span>
            <span class="Constant">'A'</span> || amtsirelsspappl.LTSIRELSSPAPPLID id,
            amtsirelsspappl.lsspid lsspid,
            CAST(amtsicustappl.code  <span class="Special">AS</span> <span class="Type">VARCHAR</span> (<span class="Constant">40</span>))       itemid,
            CAST(amtsicustappl.name  <span class="Special">AS</span> <span class="Type">VARCHAR2</span> (<span class="Constant">4000</span>))    itemname,
            CAST(<span class="Constant">'APPLICATION'</span> <span class="Special">AS</span> <span class="Type">VARCHAR2</span> (<span class="Constant">80</span>))            itemclass,
            <span class="Special">NULL</span>                                            itemdataobj,
            amtsirelsspappl.dtlastmodif
         <span class="Special">FROM</span> AM2107.amtsirelsspappl, AM2107.amtsicustappl
         <span class="Special">WHERE</span>
            amtsirelsspappl.lapplicationid = amtsicustappl.ltsicustapplid
            <span class="Statement">AND</span> amtsicustappl.bdelete = <span class="Constant">0</span>
            <span class="Statement">AND</span> amtsirelsspappl.bdelete = <span class="Constant">0</span>
      ) schainrel
      JOIN lnkschain_acl
         <span class="Special">ON</span> schainrel.lsspid=lnkschain_acl.id;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> lnkschain <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::license -----------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Lizenz-Datensatz wird dadurch eingeschraenkt,     </span>
<span class="Comment">--   dass der Schnittstellen-User ueber die IFACE_ACL entweder den Zugriff </span>
<span class="Comment">--   auf den Buchungskreis, die Assignmentgroup der Lizenz oder den aus</span>
<span class="Comment">--   dem Kontierungsobjekt resultierenden Customer-Link haben muss. </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> license_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amportfolio.assettag  id
   <span class="Special">FROM</span> AM2107.amasset
      JOIN (<span class="Statement">SELECT</span> * <span class="Special">FROM</span> AM2107.amportfolio
            <span class="Special">WHERE</span> amportfolio.bdelete=<span class="Constant">0</span>) amportfolio
         <span class="Special">ON</span> amasset.assettag = amportfolio.assettag
      LEFT OUTER JOIN (<span class="Statement">SELECT</span> *
                       <span class="Special">FROM</span> AM2107.amcostcenter
                       <span class="Special">WHERE</span> amcostcenter.bdelete=<span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amportfolio.lcostid = amcostcenter.lcostid
      left outer join AM2107.amemplgroup assigrp
         <span class="Special">on</span> amportfolio.lassignmentid = assigrp.lgroupid
      left outer join AM2107.amtsiaccsecunit customerlnk
            <span class="Special">on</span> amcostcenter.lcustomerlinkid=customerlnk.lunitid
      join IFACE_ACL acl
         <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>) <span class="Statement">and</span>
             (assigrp.name <span class="Statement">like</span> acl.assignment
                <span class="Statement">or</span> acl.assignment <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (amcostcenter.acctno <span class="Statement">like</span> acl.acctno
                <span class="Statement">or</span> acl.acctno <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
             (customerlnk.identifier <span class="Statement">like</span> acl.customerlnk
                <span class="Statement">or</span> acl.customerlnk <span class="Special">is</span> <span class="Special">null</span>) <span class="Statement">and</span>
            (acl.customerlnk <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.acctno <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span> <span class="Statement">or</span>
             acl.assignment <span class="Special">is</span> <span class="Statement">not</span> <span class="Special">null</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> license <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;licenseid&quot;</span>,
      amasset.status                                 <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      ammodel.name                                   <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amportfolio.label                              <span class="Special">AS</span> <span class="Constant">&quot;label&quot;</span>,
      amportfolio.lsupervid                          <span class="Special">AS</span> <span class="Constant">&quot;supervid&quot;</span>,
      amcostcenter.lcostid                           <span class="Special">AS</span> <span class="Constant">&quot;lcostcenterid&quot;</span>,
      amcostcenter.trimmedtitle                      <span class="Special">AS</span> <span class="Constant">&quot;cocustomeroffice&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;bc&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amportfolio.lparentid                          <span class="Special">AS</span> <span class="Constant">&quot;lassetid&quot;</span>,
      amportfolio.lportfolioitemid                   <span class="Special">AS</span> <span class="Constant">&quot;lportfolioitemid&quot;</span>,
      amportfolio.lastid                             <span class="Special">AS</span> <span class="Constant">&quot;lastid&quot;</span>,
      amcostcenter.alternatebusinesscenter           <span class="Special">AS</span> <span class="Constant">&quot;altbc&quot;</span>,
      amcomment.memcomment                           <span class="Special">AS</span> <span class="Constant">&quot;comments&quot;</span>,
      amportfolio.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amportfolio.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amasset
      JOIN (<span class="Statement">SELECT</span> * <span class="Special">FROM</span> AM2107.amportfolio
            <span class="Special">WHERE</span> amportfolio.bdelete=<span class="Constant">0</span>) amportfolio
         <span class="Special">ON</span> amasset.assettag = amportfolio.assettag
      JOIN license_acl
         <span class="Special">ON</span> amportfolio.assettag=license_acl.id
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
      JOIN AM2107.amnature
         <span class="Special">ON</span> ammodel.lnatureid = amnature.lnatureid
      LEFT OUTER JOIN AM2107.amcomment
         <span class="Special">ON</span> amasset.lcommentid = amcomment.lcommentid
      LEFT OUTER JOIN (<span class="Statement">SELECT</span> *
                       <span class="Special">FROM</span> AM2107.amcostcenter
                       <span class="Special">WHERE</span> amcostcenter.bdelete=<span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amportfolio.lcostid = amcostcenter.lcostid
   <span class="Special">WHERE</span> amnature.name = <span class="Constant">'SW-LICENSE'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> license <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itclust  ----------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Cluster-Datensatz wird dadurch eingeschraenkt,     </span>
<span class="Comment">--   dass der Schnittstellen-User ueber die IFACE_ACL entweder den Zugriff </span>
<span class="Comment">--   auf den Buchungskreis, die Assignmentgroup des Clusters oder den aus</span>
<span class="Comment">--   dem Kontierungsobjekt resultierenden Customer-Link haben muss. </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itclust_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amportfolio.assettag  id
   <span class="Special">FROM</span> AM2107.amcomputer
      JOIN AM2107.amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid
      JOIN AM2107.amasset
         <span class="Special">ON</span> amasset.assettag = amportfolio.assettag
      JOIN system
         <span class="Special">ON</span> amcomputer.lcomputerid=system.<span class="Constant">&quot;lclusterid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itclust <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> concat(amportfolio.name,concat(<span class="Constant">' ('</span>,
               concat(amportfolio.assettag,<span class="Constant">')'</span>)))    <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;clusterid&quot;</span>,
      amcomputer.status                              <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      amportfolio.usage                              <span class="Special">AS</span> <span class="Constant">&quot;usage&quot;</span>,
      amcomputer.clustertype                         <span class="Special">AS</span> <span class="Constant">&quot;clustertype&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amportfolio.lincidentagid                      <span class="Special">AS</span> <span class="Constant">&quot;lincidentagid&quot;</span>,
      decode(amportfolio.soxrelevant, <span class="Constant">'YES'</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)   <span class="Special">AS</span> <span class="Constant">&quot;soxrelevant&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lclusterid&quot;</span>,
      amportfolio.lportfolioitemid                   <span class="Special">AS</span> <span class="Constant">&quot;lportfolio&quot;</span>,
      amportfolio.lportfolioitemid                   <span class="Special">AS</span> <span class="Constant">&quot;lportfolioitemid&quot;</span>,
      amportfolio.llocaid                            <span class="Special">AS</span> <span class="Constant">&quot;locationid&quot;</span>,
      amportfolio.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amportfolio.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amcomputer
      JOIN ( <span class="Statement">SELECT</span> amportfolio.*
             <span class="Special">FROM</span> AM2107.amportfolio
             <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span>) amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid
      JOIN itclust_acl
         <span class="Special">ON</span> amportfolio.assettag=itclust_acl.id
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
      LEFT OUTER JOIN  ( <span class="Statement">SELECT</span> amcostcenter.*
              <span class="Special">FROM</span> AM2107.amcostcenter
              <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
         <span class="Special">ON</span> amportfolio.lcostid = amcostcenter.lcostid
   <span class="Special">WHERE</span> ammodel.name = <span class="Constant">'CLUSTER'</span>
      <span class="Statement">AND</span> ( amcomputer.clustertype = <span class="Constant">'Cluster'</span>
         <span class="Statement">OR</span> amcomputer.clustertype = <span class="Constant">'Oracle RAC Cluster'</span>
      )
      <span class="Statement">AND</span> amcomputer.status &lt;&gt; <span class="Constant">'out of operation'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itclust <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itclustservice ----------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen ClusterSerice-Datensatz ist dann gestattet,</span>
<span class="Comment">--   wenn der betreffende Cluster fuer den Schnittstellen-User sichtbar</span>
<span class="Comment">--   ist.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itclustservice_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> <span class="Constant">&quot;lclusterid&quot;</span> id
   <span class="Special">FROM</span> itclust;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itclustservice <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> concat(amportfolio.name,concat(<span class="Constant">' ('</span>,
            concat(amportfolio.assettag,<span class="Constant">')'</span>)))       <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amportfolio.name                               <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amcomputer.clustertype                         <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      <span class="Constant">'Cluster-Service'</span>                              <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;serviceid&quot;</span>,
      amclusterportfolio.assettag                    <span class="Special">AS</span> <span class="Constant">&quot;clusterid&quot;</span>,
      amportfolio.lassignmentid                      <span class="Special">AS</span> <span class="Constant">&quot;lassignmentid&quot;</span>,
      amportfolio.lincidentagid                      <span class="Special">AS</span> <span class="Constant">&quot;lincidentagid&quot;</span>,
      amcomputer.status                              <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>,
      amportfolio.usage                              <span class="Special">AS</span> <span class="Constant">&quot;usage&quot;</span>,
      decode(amportfolio.soxrelevant,<span class="Constant">'YES'</span>,<span class="Constant">1</span>,<span class="Constant">0</span>)      <span class="Special">AS</span> <span class="Constant">&quot;soxrelevant&quot;</span>,
      amcomputer.lparentid                           <span class="Special">AS</span> <span class="Constant">&quot;lclusterid&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>,
      amportfolio.externalsystem                     <span class="Special">AS</span> <span class="Constant">&quot;srcsys&quot;</span>,
      amportfolio.externalid                         <span class="Special">AS</span> <span class="Constant">&quot;srcid&quot;</span>
   <span class="Special">FROM</span> AM2107.amcomputer
      JOIN ( <span class="Statement">SELECT</span> amportfolio.*
             <span class="Special">FROM</span> AM2107.amportfolio
             <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span>) amportfolio
          <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid
      JOIN AM2107.ammodel
          <span class="Special">ON</span> amportfolio.lmodelid = ammodel.lmodelid
             <span class="Statement">AND</span> ammodel.name = <span class="Constant">'CLUSTER'</span>
      LEFT OUTER JOIN ( <span class="Statement">SELECT</span> amcostcenter.*
                        <span class="Special">FROM</span> AM2107.amcostcenter
                        <span class="Special">WHERE</span> amcostcenter.bdelete = <span class="Constant">0</span>) amcostcenter
          <span class="Special">ON</span> amportfolio.lcostid = amcostcenter.lcostid
      JOIN AM2107.amcomputer amcluster
          <span class="Special">ON</span> amcomputer.lparentid = amcluster.lcomputerid
      JOIN ( <span class="Statement">SELECT</span> amportfolio.*
         <span class="Special">FROM</span> AM2107.amportfolio
         <span class="Special">WHERE</span> amportfolio.bdelete = <span class="Constant">0</span>) amclusterportfolio
         <span class="Special">ON</span> amclusterportfolio.lportfolioitemid = amcluster.litemid
      JOIN itclustservice_acl
         <span class="Special">ON</span> amcomputer.lparentid=itclustservice_acl.id
   <span class="Special">WHERE</span> (amcomputer.clustertype = <span class="Constant">'Cluster-Service'</span>
          <span class="Statement">OR</span> amcomputer.clustertype = <span class="Constant">'Cluster-Package'</span>
          <span class="Statement">OR</span> amcomputer.clustertype = <span class="Constant">'Cluster-Packages'</span>
         ) <span class="Statement">AND</span> amcomputer.status &lt;&gt; <span class="Constant">'out of operation'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itclustservice <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::schain ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Serviceketten wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> service_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsiservice.lserviceid id
   <span class="Special">FROM</span> AM2107.amtsiservice
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> service <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">distinct</span> amtsiservice.lserviceid               <span class="Special">AS</span> <span class="Constant">&quot;serviceid&quot;</span>,
      amportfolio.assettag                           <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      amtsiservicetype.identifier                    <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsiservicetype.<span class="Special">type</span>                          <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      amtsiservicetype.unit                          <span class="Special">AS</span> <span class="Constant">&quot;unit&quot;</span>,
      amtsiservice.description                       <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      decode(amtsiservice.btechnical,<span class="Constant">0</span>,<span class="Constant">1</span>,<span class="Constant">1</span>,<span class="Constant">0</span>)        <span class="Special">AS</span> <span class="Constant">&quot;isordered&quot;</span>,
      amtsiservice.btechnical                        <span class="Special">AS</span> <span class="Constant">&quot;isdelivered&quot;</span>,
      amtsiservice.ammount                           <span class="Special">AS</span> <span class="Constant">&quot;ammount&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiservicetype
      JOIN AM2107.amtsiservice
         <span class="Special">ON</span> amtsiservice.lservicetypeid = amtsiservicetype.ltsiservicetypeid
      JOIN service_acl
         <span class="Special">ON</span> amtsiservice.lserviceid=service_acl.id
      JOIN AM2107.amportfolio
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amtsiservice.lportfolioid
      JOIN AM2107.amcomputer
         <span class="Special">ON</span> amportfolio.lportfolioitemid = amcomputer.litemid
   <span class="Special">WHERE</span> amtsiservice.bdelete = <span class="Constant">0</span> <span class="Statement">AND</span> amportfolio.bdelete = <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> service <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::sharedstoragemnt --------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Storage-Mountpoints wird dadurch eingeschraenkt,</span>
<span class="Comment">--   das der betreffende Schnittstellen-User auch das dazugehoerige</span>
<span class="Comment">--   System &quot;sehen&quot; muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> sharedstoragemnt_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> amtsiprovstomounts.lmountpointid      id
   <span class="Special">FROM</span>  AM2107.amtsiprovstomounts
   JOIN AM2107.amcomputer
      <span class="Special">ON</span> amtsiprovstomounts.lcomputerid = amcomputer.lcomputerid
   JOIN AM2107.amportfolio systemportfolio
      <span class="Special">ON</span> amcomputer.litemid = systemportfolio.lportfolioitemid
   JOIN system_acl_l0
      <span class="Special">ON</span> systemportfolio.assettag=system_acl_l0.id
         <span class="Statement">AND</span> system_acl_l0.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> sharedstoragemnt <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">DISTINCT</span> amtsiprovstomounts.lmountpointid      <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      concat (concat(systemportfolio.name, <span class="Constant">':'</span>),
         amtsiprovstomounts.mountpoint)              <span class="Special">AS</span> <span class="Constant">&quot;fullname&quot;</span>,
      amtsiprovstomounts.mountpoint                  <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amcomputer.lcomputerid                         <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>,
      systemportfolio.name                           <span class="Special">AS</span> <span class="Constant">&quot;systemname&quot;</span>,
      systemportfolio.assettag                       <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      amcomputer.status                              <span class="Special">AS</span> <span class="Constant">&quot;systemstatus&quot;</span>,
      assetportfolio.assettag                        <span class="Special">AS</span> <span class="Constant">&quot;storageassetid&quot;</span>,
      concat (assetportfolio.name,
         concat(<span class="Constant">' ('</span>,concat (assetportfolio.assettag,
               <span class="Constant">')'</span>)))                                <span class="Special">AS</span> <span class="Constant">&quot;storagefullname&quot;</span>,
      assetportfolio.name                            <span class="Special">AS</span> <span class="Constant">&quot;storagename&quot;</span>,
      amtsiprovstomounts.lprovidedstorageid          <span class="Special">AS</span> <span class="Constant">&quot;sharedstorageid&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsiprovstomounts
      JOIN sharedstoragemnt_acl
         <span class="Special">ON</span> amtsiprovstomounts.lmountpointid=sharedstoragemnt_acl.id
      JOIN AM2107.amcomputer
         <span class="Special">ON</span> amtsiprovstomounts.lcomputerid = amcomputer.lcomputerid
      JOIN AM2107.amportfolio systemportfolio
         <span class="Special">ON</span> amcomputer.litemid = systemportfolio.lportfolioitemid
      JOIN AM2107.amtsiprovsto
         <span class="Special">ON</span> amtsiprovstomounts.lprovidedstorageid=
            amtsiprovsto.lprovidedstorageid
      JOIN AM2107.amportfolio assetportfolio
         <span class="Special">ON</span>  amtsiprovsto.lassetid = assetportfolio.lastid
   <span class="Special">WHERE</span> amtsiprovstomounts.bdelete = <span class="Constant">'0'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> sharedstoragemnt <span class="Special">to</span> <span class="Special">public</span>;




<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::fixedasset --------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Fixed-Asset Elemente wird dadurch eingeschraenkt,</span>
<span class="Comment">--   das der betreffende Schnittstellen-User auch das dazugehoerige</span>
<span class="Comment">--   Asset &quot;sehen&quot; muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> fixedasset_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> amfixedasset.fixedastno id
   <span class="Special">FROM</span> AM2107.amfixedasset
      JOIN asset
         <span class="Special">ON</span> amfixedasset.assettag=asset.<span class="Constant">&quot;assetid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> fixedasset <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> amfixedasset.fixedastno           <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amfixedasset.name                              <span class="Special">AS</span> <span class="Constant">&quot;description&quot;</span>,
      amfixedasset.assettag                          <span class="Special">AS</span> <span class="Constant">&quot;assetid&quot;</span>,
      amfixedasset.ddeprstart                        <span class="Special">AS</span> <span class="Constant">&quot;deprstart&quot;</span>,
      amfixedasset.ddeprend                          <span class="Special">AS</span> <span class="Constant">&quot;deprend&quot;</span>,
      amfixedasset.mdeprbasis                        <span class="Special">AS</span> <span class="Constant">&quot;deprbase&quot;</span>,
      amfixedasset.mresidualvalue                    <span class="Special">AS</span> <span class="Constant">&quot;residualvalue&quot;</span>,
      amfixedasset.mdeprrate                         <span class="Special">AS</span> <span class="Constant">&quot;deprrate&quot;</span>,
      amfixedasset.inventoryno                       <span class="Special">AS</span> <span class="Constant">&quot;inventoryno&quot;</span>
   <span class="Special">FROM</span>
      AM2107.amfixedasset
      JOIN fixedasset_acl
         <span class="Special">ON</span> amfixedasset.fixedastno=fixedasset_acl.id
      JOIN AM2107.amrelfixedasset
         <span class="Special">ON</span> amfixedasset.lfixedastid = amrelfixedasset.lfixedastid
   <span class="Special">WHERE</span> amfixedasset.bdelete = <span class="Constant">'0'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> fixedasset <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::contract ----------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Serviceketten wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> contract_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amcontract.lcntrid   id
   <span class="Special">FROM</span> AM2107.amcontract
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> contract <span class="Special">AS</span>
   <span class="Statement">SELECT</span> amcontract.lcntrid                         <span class="Special">AS</span> <span class="Constant">&quot;contractid&quot;</span>,
      amcontract.name                                <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      ammodel.name                                   <span class="Special">AS</span> <span class="Constant">&quot;model&quot;</span>
   <span class="Special">FROM</span> AM2107.amcontract
      JOIN contract_acl
         <span class="Special">ON</span> amcontract.lcntrid=contract_acl.id
      JOIN AM2107.ammodel
         <span class="Special">ON</span> amcontract.lmodelid = ammodel.lmodelid
      JOIN AM2107.amnature
         <span class="Special">ON</span> ammodel.lnatureid = amnature.lnatureid;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> contract <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itfarmsystem ------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Datensatz wird dadurch eingeschraenkt,</span>
<span class="Comment">--   das der betreffende Schnittstellen-User auch das dazugehoerige</span>
<span class="Comment">--   System &quot;sehen&quot; muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmsystem_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> sys.litemid id
   <span class="Special">FROM</span> AM2107.amcomputer sys
      JOIN system <span class="Special">on</span>
         sys.assettag=system.<span class="Constant">&quot;systemid&quot;</span>;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmsystem <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> sys.litemid                       <span class="Special">AS</span> <span class="Constant">&quot;lsysid&quot;</span>,
      clu.litemid                                    <span class="Special">AS</span> <span class="Constant">&quot;lfarmid&quot;</span>,
      sysportfolio.name                              <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      sys.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
      ass.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;assetid&quot;</span>,
      clu.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;clusterid&quot;</span>,
      sys.status                                     <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>
   <span class="Special">FROM</span> AM2107.amcomputer con
      JOIN AM2107.amportfolio conportfolio
         <span class="Special">ON</span> conportfolio.lportfolioitemid = con.litemid
      JOIN AM2107.amportfolio assportfolio
         <span class="Special">ON</span> assportfolio.Lportfolioitemid = conportfolio.lparentid
      JOIN AM2107.amasset ass
         <span class="Special">ON</span> assportfolio.assettag = ass.assettag
      JOIN AM2107.amcomputer clu
         <span class="Special">ON</span> con.lparentid = clu.lcomputerid
      JOIN AM2107.amportfolio sysportfolio
         <span class="Special">ON</span> assportfolio.Lportfolioitemid = sysportfolio.lparentid
      JOIN AM2107.amcomputer sys
         <span class="Special">ON</span> sysportfolio.lportfolioitemid = sys.litemid
      JOIN itfarmsystem_acl
         <span class="Special">ON</span> sys.litemid=itfarmsystem_acl.id
   <span class="Special">WHERE</span> conportfolio.usage <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
      <span class="Statement">AND</span> sysportfolio.usage <span class="Statement">NOT</span> <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
      <span class="Statement">AND</span> clu.litemid &lt;&gt; <span class="Constant">'0'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itfarmsystem <span class="Special">to</span> <span class="Special">public</span>;





<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itfarmconsole -----------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Datensaetze wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmconsole_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amcomputer.litemid id
   <span class="Special">FROM</span> AM2107.amcomputer
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmconsole <span class="Special">AS</span>
<span class="Statement">SELECT</span>
   <span class="Statement">DISTINCT</span> con.litemid                           <span class="Special">AS</span> <span class="Constant">&quot;lconsid&quot;</span>,
   clu.litemid                                    <span class="Special">AS</span> <span class="Constant">&quot;lfarmid&quot;</span>,
   conportfolio.name                              <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
   con.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;systemid&quot;</span>,
   ass.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;assetid&quot;</span>,
   clu.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;clusterid&quot;</span>,
   con.status                                     <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>
<span class="Special">FROM</span> AM2107.amcomputer con
   JOIN itfarmconsole_acl
      <span class="Special">ON</span> con.litemid=itfarmconsole_acl.id
   JOIN AM2107.amportfolio conportfolio
      <span class="Special">ON</span> conportfolio.lportfolioitemid = con.litemid
   JOIN AM2107.amportfolio assportfolio
      <span class="Special">ON</span> assportfolio.Lportfolioitemid = conportfolio.lparentid
   JOIN AM2107.amasset ass
      <span class="Special">ON</span> assportfolio.assettag = ass.assettag
   JOIN AM2107.amcomputer clu
      <span class="Special">ON</span> con.lparentid = clu.lcomputerid
<span class="Special">WHERE</span> conportfolio.usage <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
   <span class="Statement">AND</span> clu.litemid &lt;&gt; <span class="Constant">'0'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itfarmconsole <span class="Special">to</span> <span class="Special">public</span>;



<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::itfarmasset -------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf die Datensaetze wird dadurch</span>
<span class="Comment">--   eingeschraenkt das der Schnittstellen-User in der IFACE_ACL aufgefuert</span>
<span class="Comment">--   sein muss.     </span>
<span class="Comment">-- --------------------------------------------------------------------------</span>

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmasset_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">DISTINCT</span> assportfolio.lportfolioitemid id
   <span class="Special">FROM</span> AM2107.amportfolio assportfolio
   JOIN IFACE_ACL acl
      <span class="Special">on</span> acl.ifuser=sys_context(<span class="Constant">'USERENV'</span>, <span class="Constant">'SESSION_USER'</span>);

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> itfarmasset <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">DISTINCT</span> assportfolio.lportfolioitemid         <span class="Special">AS</span> <span class="Constant">&quot;lconsid&quot;</span>,
      clu.litemid                                    <span class="Special">AS</span> <span class="Constant">&quot;lfarmid&quot;</span>,
      assportfolio.llocaid                           <span class="Special">AS</span> <span class="Constant">&quot;locationid&quot;</span>,
      ass.assettag                                   <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      ass.status                                     <span class="Special">AS</span> <span class="Constant">&quot;status&quot;</span>
   <span class="Special">FROM</span> AM2107.amcomputer sys
      JOIN AM2107.amportfolio sysportfolio
         <span class="Special">ON</span> sysportfolio.lportfolioitemid = sys.litemid
      JOIN AM2107.amportfolio assportfolio
         <span class="Special">ON</span> assportfolio.Lportfolioitemid = sysportfolio.lparentid
      JOIN AM2107.amasset ass
         <span class="Special">ON</span> assportfolio.assettag = ass.assettag
      JOIN AM2107.amcomputer clu
         <span class="Special">ON</span> sys.lparentid = clu.lcomputerid
      JOIN itfarmasset_acl
         <span class="Special">ON</span> assportfolio.lportfolioitemid=itfarmasset_acl.id
   <span class="Special">WHERE</span> sysportfolio.usage <span class="Statement">LIKE</span> <span class="Constant">'OSY-_: KONSOLSYSTEM %'</span>
      <span class="Statement">AND</span> sys.status &lt;&gt; <span class="Constant">'out of operation'</span> <span class="Statement">AND</span> clu.litemid &lt;&gt; <span class="Constant">'0'</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> itfarmasset <span class="Special">to</span> <span class="Special">public</span>;


<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">-- --------------------- tsacinv::backup ------------------------------------</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Comment">--   Der Zugriff auf einen Datensatz wird dadurch eingeschraenkt,</span>
<span class="Comment">--   das der betreffende Schnittstellen-User auch das dazugehoerige</span>
<span class="Comment">--   System &quot;sehen&quot; muss.</span>
<span class="Comment">-- --------------------------------------------------------------------------</span>
<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> backup_acl <span class="Special">AS</span>
   <span class="Statement">SELECT</span> <span class="Statement">distinct</span> amtsibackup.lbackupid id
   <span class="Special">FROM</span> AM2107.amtsibackup
      JOIN system <span class="Special">on</span> system.<span class="Constant">&quot;lcomputerid&quot;</span>=amtsibackup.lcomputerid;

<span class="Statement">CREATE</span> <span class="Statement">or</span> REPLACE <span class="Special">VIEW</span> backup <span class="Special">AS</span>
   <span class="Statement">SELECT</span>
      <span class="Statement">DISTINCT</span> amtsibackup.lbackupid                 <span class="Special">AS</span> <span class="Constant">&quot;id&quot;</span>,
      amtsibackup.code                               <span class="Special">AS</span> <span class="Constant">&quot;backupid&quot;</span>,
      amtsibackup.setype                             <span class="Special">AS</span> <span class="Constant">&quot;stype&quot;</span>,
      amtsibackup.setype                             <span class="Special">AS</span> <span class="Constant">&quot;type&quot;</span>,
      amtsibackup.setype                             <span class="Special">AS</span> <span class="Constant">&quot;typeid&quot;</span>,
      amtsibackup.subtype                            <span class="Special">AS</span> <span class="Constant">&quot;subtype&quot;</span>,
      amtsibackup.backupservice                      <span class="Special">AS</span> <span class="Constant">&quot;name&quot;</span>,
      amtsibackup.groupname                          <span class="Special">AS</span> <span class="Constant">&quot;bgroup&quot;</span>,
      concat(amtsibackup.expectedquantity,
         concat(<span class="Constant">' '</span>,amtsibackup.quantityunit))       <span class="Special">AS</span> <span class="Constant">&quot;hexpectedquantity&quot;</span>,
      amtsibackup.savetimeframefrom                  <span class="Special">AS</span> <span class="Constant">&quot;tfrom&quot;</span>,
      amtsibackup.savetimeframeto                    <span class="Special">AS</span> <span class="Constant">&quot;tto&quot;</span>,
      amtsibackup.dbtype                             <span class="Special">AS</span> <span class="Constant">&quot;dbtype&quot;</span>,
      amtsibackup.policy                             <span class="Special">AS</span> <span class="Constant">&quot;policy&quot;</span>,
      amtsibackup.dbinstance                         <span class="Special">AS</span> <span class="Constant">&quot;dbinstance&quot;</span>,
      amtsibackup.bactive                            <span class="Special">AS</span> <span class="Constant">&quot;isactive&quot;</span>,
      amtsibackup.lcomputerid                        <span class="Special">AS</span> <span class="Constant">&quot;lcomputerid&quot;</span>
   <span class="Special">FROM</span> AM2107.amtsibackup
      JOIN backup_acl
         <span class="Special">ON</span> amtsibackup.lbackupid=backup_acl.id
   <span class="Special">WHERE</span> amtsibackup.bdelete = <span class="Constant">0</span>;

<span class="Statement">grant</span> <span class="Statement">select</span> <span class="Special">on</span> backup <span class="Special">to</span> <span class="Special">public</span>;


</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
